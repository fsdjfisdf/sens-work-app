/* ==========================================================================
   S-WORKS — analysis.css (Predicted Workers) — Polished
   - Dark theme, dense tables, sticky header/col, group & total emphasis
   - Column right-align, zebra/hover, scroll shadows, focus rings
   - KPI/controls/notice tweaks, smaller charts
   - Table titles (sticky-left inside scroll container)
   - Filters: tighter grid, aligned inputs, inline-unit pills, sticky action bar
   ========================================================================== */

/* ===== Theme Tokens ===== */
:root{
  /* Palette */
  --bg:#0b0f14;
  --panel:#111720;
  --text:#e9eef5;
  --muted:#9bb0c4;
  --muted-2:#7f93a7;
  --accent:#60a5fa;
  --accent-weak:rgba(96,165,250,.35);
  --accent-bg:rgba(96,165,250,.12);
  --border:#1e2a3a;

  --surface:#0f1722;
  --surface-2:#0c121a;
  --surface-3:#0e1520;

  --ok:#22c55e;
  --ok-weak:#86efac;
  --bad:#ef4444;
  --warn:#f59e0b;

  /* Effects / layout */
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --ring:0 0 0 2px rgba(96,165,250,.65);
  --radius-lg:16px;
  --radius-md:12px;
  --radius-sm:10px;
  --ease: cubic-bezier(.2,.8,.2,1);

  /* Table */
  --table-stripe: rgba(255,255,255,0.02);
  --table-hover: rgba(96,165,250,0.08);
  --table-header-bg: var(--surface-3);
  --table-line: 1px solid var(--border);
  --table-col-min: 92px;      /* numeric cols */
  --table-col0-min: 148px;    /* first sticky col */
}

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;color:var(--text);background:var(--bg);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',Arial,sans-serif;
  -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
  font-variant-numeric: tabular-nums; /* 숫자 정렬 */
}
::selection{background:rgba(96,165,250,.25)}

.hidden{display:none!important}
.spacer{flex:1 1 auto}
.dim{opacity:.75}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* ===== Container / Header ===== */
.container{max-width:2000px;margin:32px auto;padding:0 16px}
.header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.title{font-size:26px;font-weight:800;letter-spacing:-.02em}
.pill{
  font-size:12px;color:var(--accent);background:var(--accent-bg);
  padding:6px 10px;border:1px solid var(--accent-weak);border-radius:999px
}
.right-info{margin-left:auto;opacity:.75;font-size:12px}

/* ===== NAV ===== */
nav{
  position:sticky;top:0;z-index:50;background:var(--panel);color:var(--text);
  border-bottom:1px solid var(--border);backdrop-filter:saturate(120%) blur(6px)
}
nav .inner{max-width:2000px;margin:0 auto;padding:6px 12px}
.nav-container{display:flex;align-items:center;justify-content:space-between;gap:10px}
.nav-title a{
  display:inline-block;font-weight:800;font-size:18px;color:inherit;text-decoration:none;
  padding:4px 6px;border-radius:8px;transition:color .15s var(--ease)
}
.nav-title a:hover{color:var(--accent)}
.menu-btn{
  display:flex;align-items:center;justify-content:center;height:36px;width:36px;
  border-radius:8px;border:1px solid var(--border);background:transparent;color:inherit;cursor:pointer;
  transition:background .15s var(--ease), border-color .15s var(--ease)
}
.menu-btn:hover{background:rgba(255,255,255,0.06);border-color:var(--accent)}
.menu-icon{display:inline-flex;flex-direction:column;gap:3px}
.menu-icon span{display:block;width:16px;height:2px;background:currentColor;border-radius:2px}
.menu-bar{background:var(--panel);border-top:1px solid var(--border)}
.menu-bar-content{max-width:2000px;margin:0 auto;padding:6px 10px;display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.menu-item{
  display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:8px;
  border:1px solid var(--border);color:inherit;text-decoration:none;
  transition:border-color .15s var(--ease), background .15s var(--ease), color .15s var(--ease)
}
.menu-item:hover{background:rgba(255,255,255,0.06);border-color:var(--accent);color:var(--accent)}

/* ===== Sections ===== */
.section{
  background:linear-gradient(180deg,#121a26 0%,#0e1520 100%);
  border:1px solid var(--border);border-radius:var(--radius-lg);
  box-shadow:var(--shadow);overflow:hidden;margin-bottom:14px
}
.section > summary{
  cursor:pointer;list-style:none;padding:12px 16px;border-bottom:1px solid var(--border);
  font-weight:800;display:flex;align-items:center;gap:8px;position:relative;user-select:none
}
.section > summary::-webkit-details-marker{display:none}
.section > summary::after{
  content:""; width:8px; height:8px; border-right:2px solid #9fb2c7; border-bottom:2px solid #9fb2c7;
  transform:rotate(-45deg); position:absolute; right:16px; top:50%; margin-top:-6px;
  transition:transform .18s var(--ease)
}
.section[open] > summary::after{ transform:rotate(45deg) }
.summary-badge{font-size:12px;opacity:.85;font-weight:700}
.section-body{padding:14px 16px;animation:fadeIn .2s var(--ease)}
@keyframes fadeIn{from{opacity:0;transform:translateY(-2px)}to{opacity:1;transform:none}}
.section-title{font-weight:800;margin:0 0 8px 0;letter-spacing:.2px}
.tip{
  padding:10px 12px;border-radius:var(--radius-sm);
  background:rgba(125,211,252,.08);border:1px solid rgba(125,211,252,.35);
  color:#cfe0f5;font-size:12px
}

/* ===== Grid ===== */
.grid12{display:grid;grid-template-columns:repeat(12,1fr);gap:12px 16px}
.span-12{grid-column:1/-1}.span-9{grid-column:span 9}.span-8{grid-column:span 8}
.span-6{grid-column:span 6}.span-4{grid-column:span 4}.span-3{grid-column:span 3}.span-2{grid-column:span 2}
.align-end{display:flex;align-items:end;justify-content:flex-end}

/* ===== Cards / Inputs ===== */
.card{
  background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);
  color:var(--text);padding:8px 10px;min-height:38px;display:flex;align-items:center;
  transition:border-color .15s var(--ease), box-shadow .15s var(--ease), background .15s var(--ease)
}
.card:hover{background:#0d1520}
.card:focus-within{ border-color:var(--accent); box-shadow: var(--ring) }

/* inline 컨테이너 (숫자 + 배지 등) */
.inline{display:inline-flex;align-items:center;gap:8px}
.inline.card{padding:6px 8px;min-height:38px}

.card-block{
  border:1px solid var(--border);border-radius:var(--radius-md);
  padding:12px;margin-bottom:10px;background:var(--surface)
}
.block-title{font-weight:800;margin-bottom:8px;opacity:.9}

label{font-size:12px;color:var(--muted);display:block;margin:2px 0}
small.dim{display:block;opacity:.7;margin-top:6px}
input.card, select.card{min-height:38px;width:100%;background:transparent;border:0;color:inherit;outline:none}
input.card[type=number]{-moz-appearance:textfield}
input.card::-webkit-outer-spin-button,input.card::-webkit-inner-spin-button{ -webkit-appearance: none; margin: 0 }

/* Chips / Badges */
.chip{
  display:inline-flex;align-items:center;gap:8px;background:var(--surface-2);
  border:1px solid var(--border);padding:8px 10px;border-radius:999px;font-size:12px
}
.chip input[type=checkbox]{transform:translateY(0.5px)}
.badge{
  display:inline-block;padding:2px 8px;border-radius:10px;
  background:var(--accent-bg);border:1px solid var(--accent-weak);font-weight:700
}

/* Range (alpha) */
input[type=range].card{
  -webkit-appearance:none;appearance:none;height:6px;padding:0;cursor:pointer
}
input[type=range].card::-webkit-slider-runnable-track{height:6px;background:#122036;border-radius:999px;border:1px solid var(--border)}
input[type=range].card::-webkit-slider-thumb{
  -webkit-appearance:none;appearance:none;margin-top:-6px;width:18px;height:18px;border-radius:50%;
  background:var(--accent);border:2px solid #0b1220;box-shadow:0 0 0 3px rgba(96,165,250,.25)
}
input[type=range].card::-moz-range-track{height:6px;background:#122036;border-radius:999px;border:1px solid var(--border)}
input[type=range].card::-moz-range-thumb{
  width:18px;height:18px;border-radius:50%;
  background:var(--accent);border:2px solid #0b1220;box-shadow:0 0 0 3px rgba(96,165,250,.25)
}

/* Toolbar & Buttons */
.toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:6px}
.btn{
  min-height:38px;padding:0 14px;border-radius:var(--radius-sm);
  border:1px solid var(--border);background:var(--surface-2);color:#e9eef5;cursor:pointer;
  transition:transform .05s var(--ease), background .15s var(--ease), border-color .15s var(--ease)
}
.btn:hover{background:#0d1520}
.btn:active{transform:translateY(1px)}
.btn[disabled]{opacity:.5;cursor:not-allowed}
.btn.primary{
  background:linear-gradient(180deg,#2a70ff 0%,#1a55d6 100%);
  border-color:#2a70ff;
  box-shadow:0 6px 18px rgba(42,112,255,.25)
}

/* ===== KPI ===== */
.kpis{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.kpi{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px}
.kpi .label{color:var(--muted);font-size:12px}
.kpi .value{font-size:28px;font-weight:800;margin-top:4px;letter-spacing:-.02em}
.kpi .sublabel{color:var(--muted);font-size:12px;margin-top:6px}
.delta.pos{color:var(--ok)}.delta.neg{color:var(--bad)}

/* ===== Charts (smaller heights) ===== */
#chartSeries{height:160px}
#chartWorkers{height:140px}
canvas{display:block;width:100%}
.card.chart{padding:0}
.card.chart > canvas{padding:8px 8px 0 8px}

/* ===== Scroll Areas ===== */
.scroll-x{overflow-x:auto;position:relative}
.scroll-x::-webkit-scrollbar{height:10px}
.scroll-x::-webkit-scrollbar-track{background:#0b1220;border-radius:999px}
.scroll-x::-webkit-scrollbar-thumb{background:#1e2a3a;border-radius:999px}
.scroll-x::-webkit-scrollbar-thumb:hover{background:#29405f}
.scroll-x{
  --fade-w:24px;
  mask-image: linear-gradient(to right, transparent 0, #000 var(--fade-w), #000 calc(100% - var(--fade-w)), transparent 100%);
}

/* ===== Table titles — show clearly above each table, sticky-left inside scroll ===== */
.card.scroll-x > .section-title{
  position: sticky; left: 0; top: 0; z-index: 3;
  display: inline-block;
  background: var(--table-header-bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 6px 10px;
  margin: 4px 0 10px 0;
  white-space: nowrap;
}
@supports(selector(:has(*))){
  .card.scroll-x:has(#tblTripEdit) > .section-title{ border-color: rgba(96,165,250,.55) }
  .card.scroll-x:has(#tblHiring)   > .section-title{ border-color: rgba(148,163,184,.55) }
}

/* ===== Tables — Global rules ===== */
.table{width:100%;border-collapse:separate;border-spacing:0}
.table th,.table td{
  padding:8px 10px;border-bottom:var(--table-line);vertical-align:middle;background-clip:padding-box
}
.table th{
  color:#cfe0f5;background:var(--table-header-bg);position:sticky;top:0;z-index:2;
  font-weight:700;letter-spacing:.2px;backdrop-filter:saturate(110%) blur(2px)
}
/* 숫자: 첫 열 제외 우측정렬 */
.table th:not(:first-child), .table td:not(:first-child){ text-align:right }
/* 줄무늬 + hover */
.table tbody tr:nth-child(even) td{ background: var(--table-stripe) }
.table tbody tr:hover td{ background: var(--table-hover) }
/* 컴팩트 */
.table.tight th,.table.tight td{padding:6px 8px}
.table.table-compact th,.table.table-compact td{padding:6px 8px}
/* Sticky first column */
.sticky-col{ position:sticky; left:0; z-index:3; background:var(--table-header-bg); box-shadow:1px 0 0 var(--border); min-width:var(--table-col0-min); text-align:left !important; }
/* 최소 폭 (colgroup 없을 때 폴백) */
.table th:not(:first-child), .table td:not(:first-child){ min-width: var(--table-col-min) }

/* ===== Trip Editor table (no totals here) ===== */
#tblTripEdit .sticky-col{ background:var(--table-header-bg) }
#tblTripEdit input.trip-input{
  width:64px;height:32px;border-radius:8px;border:1px solid var(--border);
  background:var(--surface-2);color:var(--text);text-align:center;outline:none;
  transition:border-color .15s var(--ease), box-shadow .15s var(--ease), background .15s var(--ease)
}
#tblTripEdit input.trip-input:focus{ border-color:var(--accent); box-shadow: var(--ring) }
#tblTripEdit input.trip-input.edited{ animation: savedFlash .7s var(--ease) }
@keyframes savedFlash{ 0%{ background:rgba(34,197,94,.25) } 100%{ background:var(--surface-2) } }
/* TripEdit: 어떤 합계/구분선도 표시 금지 (강제) */
#tblTripEdit .row-subtotal,
#tblTripEdit .row-total,
#tblTripEdit .group-divider{ display:none !important }

/* ===== Hiring table (totals & grouping ONLY here) ===== */
#tblHiring tr.group-divider td{ border-top:2px dashed rgba(148,163,184,.35) !important; }
#tblHiring tr.row-subtotal td{
  background: rgba(148,163,184,0.10) !important;
  border-top:2px solid rgba(148,163,184,.35);
  font-weight:700;
}
#tblHiring tr.row-subtotal .sticky-col{
  position:sticky;left:0;background:linear-gradient(180deg,var(--table-header-bg),var(--surface-3)) !important;
  box-shadow:2px 0 0 rgba(255,255,255,0.04);
}
#tblHiring tr.row-subtotal .sticky-col::before{
  content:""; position:absolute; left:0; top:0; bottom:0; width:4px; background:#94a3b8; opacity:.9;
  border-top-left-radius:6px; border-bottom-left-radius:6px;
}
#tblHiring tr.row-subtotal .sticky-col::after{
  content:"그룹 합계"; font-size:11px; color:#cbd5e1; margin-left:8px; padding:2px 6px;
  border:1px solid rgba(148,163,184,.45); border-radius:999px; background:rgba(148,163,184,.12);
  display:inline-block; vertical-align:middle;
}
#tblHiring tr.row-total td{
  background: rgba(96,165,250,0.12) !important;
  border-top:2px solid rgba(96,165,250,.55);
  font-weight:800;
}
#tblHiring tr.row-total .sticky-col{
  position:sticky;left:0;background:linear-gradient(180deg,var(--table-header-bg),var(--surface-3)) !important;
  box-shadow:2px 0 0 rgba(96,165,250,.25);
}
#tblHiring tr.row-total .sticky-col::before{
  content:""; position:absolute; left:0; top:0; bottom:0; width:4px; background:var(--accent); opacity:1;
  border-top-left-radius:6px; border-bottom-left-radius:6px;
}
#tblHiring tr.row-total .sticky-col::after{
  content:"전체 합계"; font-size:11px; color:#dbeafe; margin-left:8px; padding:2px 6px;
  border:1px solid rgba(96,165,250,.45); border-radius:999px; background:rgba(37,99,235,.28);
  display:inline-block; vertical-align:middle;
}
#tblHiring td.hi-plus{ color:var(--bad); font-weight:700 }
#tblHiring td.hi-zero{ opacity:.7 }

/* ===== Notices ===== */
.notice{
  margin:8px 0;padding:10px 12px;border-radius:var(--radius-sm);
  background:rgba(125,211,252,.08);border:1px solid rgba(125,211,252,.35);color:#cfe0f5
}
.notice.hidden{display:none}
.notice.error{ background:rgba(244,63,94,.08);border-color:rgba(244,63,94,.35);color:#fecaca }

/* ===== Loading Overlay ===== */
.loading{
  position:fixed;inset:0;background:rgba(2,6,23,0.35);
  display:flex;align-items:center;justify-content:center;z-index:100
}
.loading.hidden{display:none}
.loading .box{ background:#0b1220;color:#e6f0ff;border:1px solid rgba(96,165,250,.4);
  border-radius:12px;padding:14px 18px;font-weight:700;box-shadow:var(--shadow) }

/* ===== Focus-visible ===== */
a:focus-visible, button:focus-visible, select:focus-visible, input:focus-visible,
.details:focus-visible, .menu-item:focus-visible, .card:focus-within{
  outline:none; box-shadow: var(--ring)
}

/* ===== Responsive ===== */
@media (max-width:1200px){
  .span-3{grid-column:span 6}
  .span-4{grid-column:span 6}
  .span-6{grid-column:span 6}
  .span-8{grid-column:span 6}
  .span-9{grid-column:span 6}
}
@media (max-width:720px){
  .span-3,.span-4,.span-6,.span-8,.span-9,.span-12{grid-column:1/-1}
  .header{flex-wrap:wrap}
  .right-info{width:100%;margin-left:0}
  #tblTripEdit input.trip-input{ width:56px }
  .scroll-x::after{
    content:"좌우로 스크롤"; position:absolute; right:8px; bottom:6px; font-size:11px; color:var(--muted-2);
    background:rgba(2,6,23,.55); padding:2px 6px; border-radius:6px; border:1px solid rgba(255,255,255,.08)
  }
}

/* ===== Print ===== */
@media print{
  body{background:#fff;color:#000}
  nav,.menu-bar,.loading{display:none!important}
  .section{box-shadow:none;border:1px solid #ccc}
  .section > summary{border-bottom:1px solid #ddd}
  .card, .kpi, .card-block{background:#fff;border:1px solid #ccc;box-shadow:none;color:#000}
  .table th{background:#f5f7fb;color:#000;position:static}
  .sticky-col{position:static;box-shadow:none}
  .pill,.badge,.chip{border-color:#999;color:#000}
}

/* ===== Utilities ===== */
.table.align-columns{ table-layout: fixed; }
.narrative p { margin: 6px 0; line-height: 1.6; }

/* =======================================================================
   FILTERS POLISH — 첫 번째 섹션(설정)에만 적용되는 디테일
   ======================================================================= */
.section.filters .section-body{padding-top:12px}

/* 블록 간격 및 시각적 구분 강화 */
.section.filters .card-block{
  background:linear-gradient(180deg,#0f1722 0%,#0d1520 100%);
  border:1px solid rgba(96,165,250,.18);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
  margin-bottom:12px;
}
.section.filters .block-title{
  display:flex;align-items:center;gap:8px;margin-bottom:10px;
}
.section.filters .block-title::before{
  content:"";width:6px;height:6px;border-radius:2px;background:var(--accent);
  box-shadow:0 0 0 3px rgba(96,165,250,.18)
}

/* 그리드 정렬: 라벨 길이가 달라도 하단 라인이 맞게 */
.section.filters .card-block .grid12{ align-items:end }

/* 숫자 + 단위 배지 정렬 (예: 예측기간, 근무일수 힌트) */
.section.filters .inline.card{ gap:8px }
.section.filters .inline.card input[type=number]{ width:100px; text-align:right }
.section.filters .inline.card .badge{ margin-left:2px }

/* Select/Number 입력의 시각적 일관성 */
.section.filters input.card,
.section.filters select.card{ height:38px; font-size:14px; }
.section.filters input[type=number].card{ text-align:right }

/* 체크칩 줄 맞춤 및 간격 */
.section.filters .chip.inline.card{ padding:8px 12px }
.section.filters .chip.inline.card + .chip.inline.card{ margin-top:6px }

/* 보수화 옵션: 슬라이더와 값 뱃지 정렬 */
#alphaWrap, #lowerAlpha{ align-self:end }
#alphaWrap input[type=range]{ width:100% }
#lowerAlpha{ width:100% }

/* 액션바(예측 실행/초기화/CSV) — 스크롤시 하단에 살짝 붙는 효과 */
.section.filters .toolbar{
  position:sticky; bottom:6px; z-index:3;
  background: linear-gradient(180deg, rgba(14,21,32,0) 0%, rgba(14,21,32,.85) 30%, rgba(14,21,32,.98) 100%);
  padding-top:10px; margin-top:12px; border-top:1px dashed rgba(148,163,184,.28);
}

/* 라벨/도움말 간격 미세 조정 */
.section.filters label{ margin-bottom:4px }
.section.filters small.dim{ margin-top:6px }

/* 모바일에서 필터 입력 터치 영역 확대 */
@media (max-width: 720px){
  .section.filters input.card, .section.filters select.card{ min-height:42px; font-size:15px }
  .section.filters .chip.inline.card{ padding:10px 12px }
  .section.filters .inline.card input[type=number]{ width:110px }
}

/* 접근성: 포커스 도우미 */
.section.filters .card:focus-within,
.section.filters .chip:has(input:focus-visible){
  box-shadow: var(--ring);
  border-color: var(--accent);
}
