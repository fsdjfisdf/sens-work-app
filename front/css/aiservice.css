/* ============================================================
   front/css/aiservice.css
   ChatGPT 스타일 AI 채팅 UI
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Noto+Sans+KR:wght@400;500;600;700&display=swap');

/* ── 변수 ─────────────────────────────────────────────────── */
:root {
  /* ChatGPT 다크 팔레트 */
  --sidebar-bg:    #202123;
  --sidebar-hover: #2a2b32;
  --main-bg:       #343541;
  --user-bg:       #40414f;
  --ai-bg:         #444654;
  --input-bg:      #40414f;
  --input-border:  #565869;
  --border:        #4e4f60;

  /* 텍스트 */
  --tx-1:   #ececf1;
  --tx-2:   #c5c5d2;
  --tx-3:   #8e8ea0;
  --tx-4:   #565869;

  /* 액센트 */
  --accent:      #10a37f;   /* ChatGPT 그린 */
  --accent-dim:  rgba(16,163,127,.15);
  --accent-glow: rgba(16,163,127,.4);
  --amber:       #f5a623;
  --amber-dim:   rgba(245,166,35,.15);
  --red:         #ef4444;

  /* 폰트 */
  --f-mono: 'IBM Plex Mono', monospace;
  --f-body: 'Noto Sans KR', sans-serif;

  /* 레이아웃 */
  --sidebar-w:  260px;
  --radius:     8px;
  --radius-lg:  12px;
  --transition: 0.18s ease;
}

/* ── 리셋 ─────────────────────────────────────────────────── */
*,*::before,*::after { box-sizing:border-box; margin:0; padding:0; }
html,body { height:100%; overflow:hidden; }
body {
  font-family: var(--f-body);
  font-size: 15px;
  line-height: 1.65;
  background: var(--main-bg);
  color: var(--tx-1);
  display: flex;
}
a { text-decoration:none; color:inherit; }
button { cursor:pointer; border:none; background:none; font-family:inherit; font-size:inherit; }
input,select,textarea { font-family:inherit; font-size:inherit; color:inherit; }

::-webkit-scrollbar         { width:5px; }
::-webkit-scrollbar-track   { background:transparent; }
::-webkit-scrollbar-thumb   { background:var(--border); border-radius:3px; }

/* ══════════════════════════════════════════════════════════
   사이드바
══════════════════════════════════════════════════════════ */
.sidebar {
  width: var(--sidebar-w);
  min-width: var(--sidebar-w);
  height: 100vh;
  background: var(--sidebar-bg);
  display: flex;
  flex-direction: column;
  padding: 8px;
  overflow-y: auto;
  flex-shrink: 0;
  transition: transform var(--transition);
}

/* 상단 */
.sidebar-top {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px 4px 12px;
  border-bottom: 1px solid rgba(255,255,255,.08);
  margin-bottom: 8px;
}

.sidebar-logo {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  font-size: 15px;
  font-weight: 600;
  color: var(--tx-1);
}
.logo-icon { font-size: 18px; }
.logo-text strong { color: var(--accent); }

.btn-new-chat {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 10px 12px;
  border: 1px solid rgba(255,255,255,.15);
  border-radius: var(--radius);
  color: var(--tx-1);
  font-size: 14px;
  font-weight: 500;
  transition: background var(--transition);
}
.btn-new-chat:hover { background: var(--sidebar-hover); }
.btn-new-chat svg   { flex-shrink: 0; }

/* 필터 섹션 */
.sidebar-filters {
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 0 4px 14px;
  border-bottom: 1px solid rgba(255,255,255,.08);
  margin-bottom: 8px;
}

.filter-section-label {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .08em;
  color: var(--tx-3);
  padding: 6px 4px 2px;
}

.filter-item        { display:flex; flex-direction:column; gap:5px; }
.filter-label {
  font-size: 12px;
  color: var(--tx-2);
  display: flex;
  align-items: center;
  gap: 4px;
}
.req-dot { color: var(--amber); font-size: 14px; line-height: 1; }

.filter-select,
.filter-input {
  width: 100%;
  background: var(--user-bg);
  border: 1px solid rgba(255,255,255,.1);
  border-radius: var(--radius);
  color: var(--tx-1);
  padding: 8px 10px;
  font-size: 13px;
  transition: border-color var(--transition);
}
.filter-select:focus,
.filter-input:focus  {
  outline: none;
  border-color: var(--accent);
}
.filter-input::placeholder { color: var(--tx-4); }
.filter-select option       { background: var(--sidebar-bg); }

.filter-item.filter-required .filter-select {
  border-color: rgba(245,166,35,.4);
}
.filter-item.filter-required .filter-select:focus {
  border-color: var(--amber);
}

/* 히스토리 */
.sidebar-history { flex: 1; overflow-y: auto; padding: 0 4px; }
.history-list    { list-style: none; display:flex; flex-direction:column; gap:2px; }
.history-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: var(--radius);
  font-size: 13px;
  color: var(--tx-2);
  cursor: pointer;
  transition: background var(--transition);
  overflow: hidden;
}
.history-item:hover   { background: var(--sidebar-hover); color: var(--tx-1); }
.history-item.active  { background: var(--sidebar-hover); color: var(--tx-1); }
.history-item svg     { flex-shrink: 0; opacity: .5; }
.history-text         { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* 하단 네비 */
.sidebar-bottom {
  padding: 8px 4px;
  border-top: 1px solid rgba(255,255,255,.08);
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.sidebar-nav-link {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: var(--radius);
  font-size: 13px;
  color: var(--tx-2);
  transition: background var(--transition);
}
.sidebar-nav-link:hover { background: var(--sidebar-hover); color: var(--tx-1); }

/* 사이드바 토글 (모바일) */
.sidebar-toggle {
  display: none;
  position: fixed;
  top: 12px; left: 12px;
  z-index: 200;
  width: 38px; height: 38px;
  background: var(--sidebar-bg);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--tx-1);
  align-items: center; justify-content: center;
}

/* ══════════════════════════════════════════════════════════
   메인 채팅 영역
══════════════════════════════════════════════════════════ */
.chat-main {
  flex: 1;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
}

/* ── 웰컴 화면 ────────────────────────────────────────────── */
.welcome-screen {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow-y: auto;
}
.welcome-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  padding: 40px 24px;
  max-width: 680px;
  width: 100%;
  text-align: center;
}
.welcome-icon {
  font-size: 52px;
  line-height: 1;
  animation: floatIcon 3s ease-in-out infinite;
}
@keyframes floatIcon {
  0%,100% { transform: translateY(0); }
  50%      { transform: translateY(-6px); }
}
.welcome-title {
  font-size: 28px;
  font-weight: 700;
  color: var(--tx-1);
}
.welcome-sub {
  font-size: 15px;
  color: var(--tx-2);
  line-height: 1.7;
}

/* 예시 카드 */
.example-cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  width: 100%;
  margin-top: 8px;
}
.example-card {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 14px 16px;
  background: var(--user-bg);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: var(--radius-lg);
  text-align: left;
  color: var(--tx-2);
  font-size: 13.5px;
  line-height: 1.5;
  transition: all var(--transition);
}
.example-card:hover {
  background: var(--ai-bg);
  border-color: rgba(255,255,255,.15);
  color: var(--tx-1);
  transform: translateY(-1px);
}
.ex-icon { font-size: 18px; flex-shrink: 0; margin-top: 1px; }
.ex-text  { flex: 1; }

/* ── 메시지 목록 ──────────────────────────────────────────── */
.messages-wrap {
  flex: 1;
  overflow-y: auto;
  display: none; /* 대화 시작 후 보임 */
  flex-direction: column;
  padding-bottom: 20px;
}
.messages-wrap.visible { display: flex; }

/* 메시지 공통 */
.msg-row {
  display: flex;
  justify-content: center;
  padding: 24px 0;
  border-bottom: 1px solid rgba(255,255,255,.04);
}
.msg-row:last-child { border-bottom: none; }

.msg-inner {
  width: 100%;
  max-width: 760px;
  padding: 0 28px;
  display: flex;
  gap: 16px;
}

/* 아바타 */
.msg-avatar {
  width: 32px;
  height: 32px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
  margin-top: 2px;
}
.msg-avatar.user-avatar {
  background: var(--accent);
  color: #fff;
  font-size: 13px;
  font-weight: 700;
}
.msg-avatar.ai-avatar {
  background: #19c37d;
  color: #fff;
}

/* 메시지 내용 */
.msg-content { flex: 1; min-width: 0; }
.msg-name {
  font-size: 13px;
  font-weight: 700;
  color: var(--tx-1);
  margin-bottom: 6px;
}

/* 사용자 메시지 */
.msg-row.user-row { background: var(--user-bg); }
.user-text {
  font-size: 15px;
  color: var(--tx-1);
  line-height: 1.7;
  white-space: pre-wrap;
  word-break: break-word;
}

/* 필터 태그 */
.filter-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 8px;
}
.filter-tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 10px;
  background: var(--accent-dim);
  border: 1px solid var(--accent-glow);
  border-radius: 20px;
  font-size: 11.5px;
  color: var(--accent);
  font-weight: 600;
}

/* AI 응답 */
.msg-row.ai-row { background: var(--ai-bg); }
.ai-summary {
  font-size: 15px;
  color: var(--tx-1);
  line-height: 1.8;
  white-space: pre-wrap;
  word-break: break-word;
}

/* 결과 카드 목록 */
.result-cards {
  margin-top: 18px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.result-cards-title {
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .07em;
  color: var(--tx-3);
  margin-bottom: 4px;
}

.result-card {
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: var(--radius);
  padding: 14px 16px;
  cursor: pointer;
  transition: all var(--transition);
}
.result-card:hover {
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.15);
}
.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 6px;
  flex-wrap: wrap;
}
.card-title {
  font-size: 13.5px;
  font-weight: 600;
  color: var(--tx-1);
}
.card-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}
.card-date {
  font-family: var(--f-mono);
  font-size: 11.5px;
  color: var(--tx-3);
}
.card-site {
  font-size: 11.5px;
  color: var(--tx-3);
}
.card-body {
  font-size: 13px;
  color: var(--tx-2);
  line-height: 1.6;
}
.card-desc {
  margin-top: 5px;
  font-size: 13px;
  color: var(--tx-2);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
.card-worker {
  margin-top: 6px;
  font-size: 12px;
  color: var(--tx-3);
}
.worker-main-tag    { color: var(--accent); font-weight: 600; }
.worker-support-tag { color: var(--tx-3); }

/* work_type2 배지 */
.wt-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 700;
  font-family: var(--f-mono);
}
.wt-REP { background:rgba(62,207,142,.15); color:#3ecf8e; }
.wt-ADJ { background:rgba(100,181,246,.15); color:#64b5f6; }
.wt-MON { background:rgba(255,213,79,.15);  color:#ffd54f; }
.wt-CLN { background:rgba(206,147,216,.15); color:#ce93d8; }
.wt-def { background:rgba(255,255,255,.08); color:var(--tx-3); }

/* 더보기 버튼 */
.btn-expand-card {
  width: 100%;
  padding: 10px;
  margin-top: 4px;
  background: transparent;
  border: 1px dashed rgba(255,255,255,.12);
  border-radius: var(--radius);
  color: var(--tx-3);
  font-size: 12.5px;
  text-align: center;
  transition: all var(--transition);
}
.btn-expand-card:hover { border-color:var(--accent); color:var(--accent); }

/* AI 응답 하단 액션 */
.ai-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 14px;
}
.ai-action-btn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 12px;
  border: 1px solid rgba(255,255,255,.1);
  border-radius: var(--radius);
  color: var(--tx-3);
  font-size: 12px;
  transition: all var(--transition);
}
.ai-action-btn:hover { border-color:var(--accent); color:var(--accent); }
.ai-meta-text {
  margin-left: auto;
  font-size: 11.5px;
  color: var(--tx-4);
  font-family: var(--f-mono);
}

/* 로딩 메시지 */
.msg-row.loading-row .ai-summary { color: var(--tx-3); }
.typing-indicator {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 0;
}
.typing-dot {
  width: 7px; height: 7px;
  background: var(--tx-3);
  border-radius: 50%;
  animation: typingBounce 1.2s ease-in-out infinite;
}
.typing-dot:nth-child(2) { animation-delay: .18s; }
.typing-dot:nth-child(3) { animation-delay: .36s; }
@keyframes typingBounce {
  0%,80%,100% { transform:translateY(0); opacity:.4; }
  40%          { transform:translateY(-6px); opacity:1; }
}

/* 결과 없음 */
.no-result-msg {
  padding: 20px 0;
  color: var(--tx-3);
  font-size: 14px;
}

/* ── 에러 토스트 ──────────────────────────────────────────── */
.error-toast {
  position: absolute;
  top: 16px; left: 50%; transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 18px;
  background: #2d1b1b;
  border: 1px solid rgba(239,68,68,.4);
  border-radius: var(--radius-lg);
  color: #fca5a5;
  font-size: 13.5px;
  max-width: 480px;
  z-index: 50;
  box-shadow: 0 4px 20px rgba(0,0,0,.4);
}
.toast-icon  { font-size: 16px; flex-shrink: 0; }
.toast-close {
  margin-left: auto; flex-shrink: 0;
  color: #fca5a5; font-size: 14px;
  width: 24px; height: 24px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 4px;
  transition: background var(--transition);
}
.toast-close:hover { background: rgba(255,255,255,.1); }

/* ── 입력 영역 ────────────────────────────────────────────── */
.input-area {
  padding: 12px 16px 16px;
  background: var(--main-bg);
  border-top: 1px solid rgba(255,255,255,.06);
}

.input-box-wrap {
  display: flex;
  align-items: flex-end;
  gap: 10px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--radius-lg);
  padding: 10px 10px 10px 16px;
  transition: border-color var(--transition), box-shadow var(--transition);
}
.input-box-wrap:focus-within {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-dim);
}

.input-box {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  color: var(--tx-1);
  font-size: 15px;
  line-height: 1.6;
  resize: none;
  max-height: 180px;
  overflow-y: auto;
}
.input-box::placeholder { color: var(--tx-4); }

.btn-send {
  width: 36px; height: 36px;
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  background: var(--accent);
  border-radius: var(--radius);
  color: #fff;
  transition: all var(--transition);
}
.btn-send:hover:not(:disabled)  {
  background: #0d8f6f;
  box-shadow: 0 2px 10px var(--accent-glow);
}
.btn-send:disabled {
  background: var(--tx-4);
  cursor: not-allowed;
}

.input-hint {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 4px 0;
  font-size: 12px;
}
.filter-status       { color: var(--tx-3); }
.filter-status.filter-ok      { color: var(--accent); }
.filter-status.filter-missing { color: var(--amber); }
.char-count          { color: var(--tx-4); font-family: var(--f-mono); font-size: 11px; }

/* ── 모달 ─────────────────────────────────────────────────── */
.modal-overlay {
  position: fixed; inset: 0; z-index: 300;
  background: rgba(0,0,0,.7); backdrop-filter: blur(5px);
  display: flex; align-items: center; justify-content: center;
  padding: 24px;
}
.modal-box {
  background: #2a2b36;
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  width: 100%; max-width: 720px; max-height: 88vh;
  display: flex; flex-direction: column;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  animation: modalIn .18s ease-out;
}
@keyframes modalIn {
  from { opacity:0; transform:scale(.95); }
  to   { opacity:1; transform:scale(1); }
}
.modal-head {
  display: flex; align-items: center; justify-content: space-between;
  padding: 16px 22px; border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.modal-title { font-size: 15px; font-weight: 700; color: var(--tx-1); }
.modal-close {
  width:30px; height:30px; display:flex; align-items:center; justify-content:center;
  border:1px solid var(--border); border-radius:6px;
  color:var(--tx-2); font-size:14px; transition:all var(--transition);
}
.modal-close:hover { border-color:var(--red); color:var(--red); background:rgba(239,68,68,.1); }
.modal-body {
  padding: 22px 24px; overflow-y: auto;
  display: flex; flex-direction: column; gap: 14px;
}

/* 모달 내 필드 */
.m-row   { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
.m-row-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:14px; }
.m-field { display:flex; flex-direction:column; gap:4px; }
.m-label {
  font-size: 10.5px; font-weight:700; text-transform:uppercase;
  letter-spacing:.08em; color:var(--tx-3);
}
.m-value {
  font-size: 14px; color:var(--tx-1);
  line-height: 1.75; white-space:pre-wrap; word-break:break-word;
}
.m-value.highlight {
  background: rgba(16,163,127,.08);
  border-left: 2px solid var(--accent);
  padding: 10px 14px;
  border-radius: 0 6px 6px 0;
}
.m-divider { height:1px; background:var(--border); margin:2px 0; }

/* ── 유틸 ─────────────────────────────────────────────────── */
.hidden { display:none !important; }

/* ── 반응형 ─────────────────────────────────────────────────── */
@media (max-width: 768px) {
  body { flex-direction: column; overflow: auto; }

  .sidebar {
    position: fixed;
    top: 0; left: 0;
    height: 100vh;
    z-index: 150;
    transform: translateX(-100%);
  }
  .sidebar.open         { transform: translateX(0); }
  .sidebar-toggle       { display: flex; }
  .chat-main            { height: 100vh; }
  .msg-inner            { padding: 0 16px; }
  .example-cards        { grid-template-columns: 1fr; }
  .m-row, .m-row-3      { grid-template-columns: 1fr; }
}
