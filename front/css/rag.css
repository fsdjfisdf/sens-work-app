/* ====== ChatGPT-like full app skin ====== */
:root{
  --accent:#10a37f;
  --accent-2:#dff7ef;
  --bg:#f6f7f9;
  --panel:#ffffff;
  --text:#111418;
  --muted:#6b7280;
  --stroke:#e7eaf0;
  --shadow:0 10px 30px rgba(17,24,39,.07);
  --radius:16px;

  --side-bg:#0f1418;
  --side-stroke:#1f2a34;
  --side-muted:#9ba7b4;
  --side-text:#e8eef4;
}

/* Dark preference tweaks */
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b0f12;
    --panel:#0f1418;
    --text:#e8eef4;
    --muted:#9fb0be;
    --stroke:#1f2a34;
    --shadow:0 10px 30px rgba(0,0,0,.5);

    --side-bg:#0b0f12;
    --side-stroke:#1a222a;
    --side-muted:#90a0ad;
    --side-text:#e8eef4;
    --accent-2:rgba(16,163,127,.12);
  }
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background:
    radial-gradient(1000px 500px at -10% -10%, rgba(16,163,127,.08), transparent 60%),
    radial-gradient(900px 600px at 120% -20%, rgba(16,163,127,.06), transparent 60%),
    var(--bg);
  color:var(--text);
  font:14.5px/1.6 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Malgun Gothic, Helvetica, Arial;
}

/* ====== Layout ====== */
.app{
  height:100vh; display:grid;
  grid-template-columns: 280px 1fr;
  grid-template-rows: 100%;
}

/* Sidebar */
.sidebar{
  background:var(--side-bg);
  color:var(--side-text);
  border-right:1px solid var(--side-stroke);
  display:flex; flex-direction:column; gap:14px;
  padding:14px;
}
.side-top{ display:flex; }
.side-section{ border-top:1px solid var(--side-stroke); padding-top:12px; }
.side-title{ font-weight:700; color:var(--side-muted); margin-bottom:10px; font-size:12px; text-transform:uppercase; letter-spacing:.06em }
.history-list{ display:flex; flex-direction:column; gap:6px; max-height:40vh; overflow:auto; }
.history-item{
  background:transparent; color:var(--side-text);
  border:1px solid var(--side-stroke);
  border-radius:12px; padding:10px; text-align:left; cursor:pointer;
  opacity:.92;
}
.history-item:hover{ background:rgba(255,255,255,.04) }
.history-item .title{ display:block; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.history-item .sub{ font-size:12px; color:var(--side-muted); margin-top:4px; }

.side-bottom{ margin-top:auto; display:flex; flex-direction:column; gap:6px }
.badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 10px; border-radius:999px; border:1px solid var(--side-stroke);
  color:var(--accent);
}
.small{ font-size:12px }
.muted{ color:var(--muted) }

/* Sidebar controls */
.kv{ display:grid; grid-template-columns: 90px 1fr; gap:8px; align-items:center; margin:8px 0 }
.kv label{ color:var(--side-muted); font-size:12.5px }
.kv input{
  width:100%; padding:8px 10px; border-radius:10px; background:#0b0f12; color:#dfe7ee; border:1px solid var(--side-stroke);
}
.btn.side{
  width:100%; padding:10px 12px; border-radius:10px; cursor:pointer;
  border:1px solid var(--side-stroke); color:var(--side-text); background:#111820;
}
.btn.side.primary{ background:#122126; border-color:#153137; color:#e8eef4 }
.btn.side.ghost{ background:transparent }
.btn.side:hover{ filter:brightness(1.05) }

/* Main */
.main{
  display:grid; grid-template-rows: auto 1fr auto; min-height:100vh;
}
.topbar{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:14px 18px;
  backdrop-filter:saturate(140%) blur(8px);
  background:linear-gradient(to bottom, rgba(255,255,255,.75), rgba(255,255,255,.55));
  border-bottom:1px solid var(--stroke);
}
@media (prefers-color-scheme: dark){
  .topbar{ background:linear-gradient(to bottom, rgba(15,20,24,.75), rgba(15,20,24,.55)); }
}
.brand{ display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px }
.mark{ color:var(--accent) }
.chips{ display:flex; gap:8px; flex-wrap:wrap }
.chip{
  display:inline-flex; align-items:center; gap:6px;
  padding:4px 10px; border-radius:999px; font-size:12px;
  background:var(--accent-2); color:#0a4f3f; border:1px solid rgba(16,163,127,.25);
}
.chip.model{ font-variant-numeric:tabular-nums }

/* Chat area */
.chat{
  padding:22px 18px 26px; overflow:auto; display:flex; flex-direction:column; gap:14px;
}
.msg{
  display:flex; gap:12px; align-items:flex-start;
}
.avatar{
  width:30px; height:30px; border-radius:50%;
  display:inline-grid; place-items:center; font-weight:700; font-size:12px;
  background:#e9f7f2; color:#0a4f3f; border:1px solid rgba(16,163,127,.25);
}
@media (prefers-color-scheme: dark){
  .avatar{ background:rgba(16,163,127,.14); color:#aaf0d6 }
}
.avatar.user{ background:#eaf1fe; color:#1a3f8f; border-color:#cfd9fb }
@media (prefers-color-scheme: dark){
  .avatar.user{ background:rgba(56,112,255,.15); color:#cfe0ff; border-color:#24345a }
}
.bubble{
  max-width:900px;
  border:1px solid var(--stroke); border-radius:16px;
  padding:14px 16px; background:var(--panel); box-shadow:var(--shadow);
}
.bubble.assistant{ background:linear-gradient(180deg, rgba(0,0,0,.02), transparent 60%) }
.bubble.user{
  background:linear-gradient(180deg, rgba(16,163,127,.07), rgba(16,163,127,.02));
  border-color:rgba(16,163,127,.25);
}
.meta{ font-size:12px; color:var(--muted); margin-bottom:6px }
.markdown{ white-space:pre-wrap }
.markdown p{ margin: 0 0 10px 0 }
.markdown ul{ margin:8px 0 8px 22px }
.markdown li{ margin:2px 0 }
.markdown h3{ margin:12px 0 8px; font-size:16px }
pre{ margin:8px 0; padding:10px 12px; background:rgba(2,6,12,.05); border-radius:10px; overflow:auto; border:1px solid var(--stroke) }
code{ font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12.5px }

/* Evidence (inside assistant message) */
.evidence{
  margin-top:10px;
}
.table-wrap{ overflow:auto; border-radius:12px; border:1px solid var(--stroke) }
.evidence table{ width:100%; border-collapse:collapse; background:var(--panel) }
.evidence th, .evidence td{ border-bottom:1px solid var(--stroke); padding:10px; text-align:left; vertical-align:top }
.evidence thead th{ position:sticky; top:0; background:linear-gradient(180deg, rgba(16,163,127,.05), transparent) }
.evidence .sim{ text-align:right; font-variant-numeric:tabular-nums }
.evidence .idcell{ font-weight:700 }
.evidence .desc{ color:#3a4252 }
@media (prefers-color-scheme: dark){
  .evidence .desc{ color:#c4ccd6 }
}

/* Composer */
.composer{
  border-top:1px solid var(--stroke);
  padding:12px 18px 18px; background:linear-gradient(to top, rgba(0,0,0,.03), transparent);
}
.composer-box{
  border:1px solid var(--stroke); border-radius:14px; background:var(--panel); box-shadow:var(--shadow);
  padding:8px; display:flex; flex-direction:column; gap:8px;
}
.composer textarea{
  width:100%; min-height:24px; max-height:180px; resize:none; border:none; outline:none;
  background:transparent; color:var(--text); font:inherit; padding:6px 8px;
}
.composer-actions{ display:flex; align-items:center; gap:8px; }
.gap{ flex:1 }
.btn{
  border:1px solid var(--stroke); background:#fff; color:var(--text);
  padding:9px 14px; border-radius:12px; cursor:pointer;
  transition:transform .06s ease, background .15s ease;
}
.btn:hover{ transform:translateY(-1px) }
.btn.primary{ background:var(--accent); color:#fff; border-color:var(--accent) }
.btn.subtle{ background:#eef2f7 }
@media (prefers-color-scheme: dark){
  .btn.subtle{ background:#1a222a; color:#d6dde5 }
}

/* Status typing dots */
.status{ min-height:20px; color:var(--muted) }
.status.typing:not(:empty)::before{
  content: ""; display:inline-block; width:4px; height:4px; border-radius:50%; background:var(--muted);
  margin-left:6px;
  box-shadow: 8px 0 0 var(--muted), 16px 0 0 var(--muted);
  animation: dots 1.2s infinite linear;
}
@keyframes dots {
  0% { box-shadow: 8px 0 0 var(--muted), 16px 0 0 var(--muted); }
  33% { box-shadow: 8px -6px 0 var(--muted), 16px 0 0 var(--muted); }
  66% { box-shadow: 8px 0 0 var(--muted), 16px -6px 0 var(--muted); }
  100% { box-shadow: 8px 0 0 var(--muted), 16px 0 0 var(--muted); }
}

/* Responsive */
@media (max-width: 980px){
  .app{ grid-template-columns: 72px 1fr; }
  .side-section .kv{ grid-template-columns: 1fr; }
  .side-top .btn.side.primary{ font-size:12px; }
  .side-section .side-title{ display:none }
  .kv label{ display:none }
}

/* Scrollbar polite */
.chat::-webkit-scrollbar,
.history-list::-webkit-scrollbar{ height:8px; width:8px }
.chat::-webkit-scrollbar-thumb,
.history-list::-webkit-scrollbar-thumb{ background:#cfd6de; border-radius:999px }
@media (prefers-color-scheme: dark){
  .chat::-webkit-scrollbar-thumb,
  .history-list::-webkit-scrollbar-thumb{ background:#263241 }
}
