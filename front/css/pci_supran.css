/* =============================================================================
   S-WORKS — SUPRA N PCI (mobile-first, clean, wide matrix)
   - Inspired by approval.css tokens
   ========================================================================== */

/* ---------- Design Tokens -------------------------------------------------- */
:root{
  /* Surfaces */
  --bg:#ffffff;
  --surface:#f6f8fb;
  --panel:#ffffff;
  --panel-2:#fafcff;

  /* Text */
  --text:#0f172a;
  --muted:#475569;

  /* Brand & Accents */
  --accent:#2563eb;
  --accent-weak: rgba(37,99,235,.14);
  --accent-soft: color-mix(in srgb, var(--accent) 7%, #fff 93%);

  /* Status */
  --ok:#16a34a;
  --warn:#b08900;
  --bad:#dc2626;

  /* Lines & Shadows */
  --border:#e2e8f0;
  --hair:#eef2f7;
  --inset:#eef2f7;

  --shadow-xs: 0 1px 1px rgba(2,6,23,.06);
  --shadow-sm: 0 1px 2px rgba(2,6,23,.08);
  --shadow:    0 8px 24px rgba(2,6,23,.10);
  --shadow-lg: 0 16px 40px rgba(2,6,23,.14);

  /* Focus ring */
  --ring-outer:0 0 0 4px rgba(37,99,235,.14);
  --ring-inner:0 0 0 1px rgba(37,99,235,.55);

  /* Radius & Sizes */
  --radius:16px; --radius-md:12px; --radius-sm:10px; --radius-xs:8px;
  --control-h:44px; --font-control:16px;

  /* Layout */
  --page-max: 1680px;
  --sticky-offset: env(safe-area-inset-top, 0px);
}

/* ---------- Base ----------------------------------------------------------- */
*,
*::before,*::after{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  background: linear-gradient(180deg, #fff 0 64px, var(--surface) 64px 100%);
  color:var(--text);
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', Arial, sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  text-size-adjust: 100%;
}

::selection{ background: var(--accent-weak); }
a{ color:var(--accent); text-decoration:none; text-underline-offset:2px; }
a:hover{ text-decoration:underline; }

.muted{ color:#667892; }
.hint{ color:#667892; font-size:12.5px; }
.small{ font-size:12.5px; }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-variant-numeric: tabular-nums; }
.hidden{ display:none !important; }

:where(a,button,input,select,textarea){ touch-action: manipulation; }
:where(a,button,input,select,textarea):focus-visible{
  outline:0; box-shadow: var(--ring-inner), var(--ring-outer);
  border-color: rgba(37,99,235,.55) !important;
}
input, select, textarea{ font-size: var(--font-control); caret-color: var(--accent); }
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
input[type="number"]{ -moz-appearance:textfield; }

/* ---------- Nav ------------------------------------------------------------ */
.nav{
  position:sticky; top:0; z-index:8000;
  background:#fff; color:var(--text);
  border-bottom:1px solid var(--border); box-shadow:var(--shadow);
  padding-top: env(safe-area-inset-top);
}
.nav .inner{ max-width:var(--page-max); margin:0 auto; padding:0 12px; }
.brand{ font-weight:800; font-size:18px; color:inherit; padding:6px 6px; border-radius:8px; display:inline-block; }
.brand:hover{ color:var(--accent); }
.page-title{ font-weight:800; }

/* ---------- Page Frame ----------------------------------------------------- */
.container{ max-width:var(--page-max); margin:20px auto 32px; padding:0 12px; }
.panel{
  background:var(--panel); border:1px solid var(--border);
  border-radius:var(--radius); box-shadow:var(--shadow);
  margin-bottom:18px;
}
.panel-header{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  padding:14px 16px; border-bottom:1px solid var(--inset);
}
.panel-header h2{ margin:0; font-size:18px; font-weight:900; letter-spacing:-.01em; }

/* ---------- Tabs ----------------------------------------------------------- */
.tabs{ display:flex; gap:8px; margin:0 0 12px 0; }
.tab{
  min-height:36px; padding:0 14px; border-radius:999px; border:1px solid var(--border);
  background:#fff; cursor:pointer; box-shadow:var(--shadow-xs);
  font-weight:800; font-size:13px; color:#1f2a3a;
}
.tab.active{ border-color:var(--accent); color:#0b1220; background:var(--accent-soft); }
.tab-pane{ display:none; }
.tab-pane.active{ display:block; }

/* ---------- Filters -------------------------------------------------------- */
.filters{
  margin:12px 16px; background:var(--panel-2);
  border:1px solid var(--inset); border-radius:var(--radius-md);
  box-shadow:var(--shadow-sm); padding:12px;
  display:grid; grid-template-columns: repeat(12, 1fr); gap:10px 12px; align-items:end;
}
.field{ display:flex; flex-direction:column; gap:6px; grid-column:span 3; min-width:0; }
.field.actions{ align-self:end; flex-direction:row; gap:8px; grid-column:span 3; }
.field > label{ font-size:12.5px; color:#4b5563; font-weight:700; padding-left:2px; }

.input, input[type="text"], input[type="number"], select{
  height: var(--control-h);
  border-radius: var(--radius-sm);
  border:1px solid var(--border); background:#fff; color:var(--text);
  padding:0 12px; box-shadow: inset 0 1px 0 rgba(2,6,23,.04);
  font-size: var(--font-control); width:100%;
}
.btn{
  min-height: 40px; padding:0 12px; border-radius:10px;
  border:1px solid var(--border); background:#fff; color:var(--text);
  font-size:13px; font-weight:800; cursor:pointer; box-shadow:var(--shadow-xs);
  transition:transform .06s, background .16s, border-color .16s, color .16s, box-shadow .16s;
}
.btn:hover{ background:#f1f5f9; border-color:var(--accent); color:var(--accent); box-shadow:var(--shadow-sm); }
.btn:active{ transform:translateY(1px); }
.btn.primary{
  min-height:44px; border-radius:12px; background: linear-gradient(180deg, color-mix(in srgb, var(--ok) 10%, #fff), #fff);
  border-color: color-mix(in srgb, var(--ok) 40%, var(--border)); color:#0b1220;
}

/* Category chips */
.cat-filter{ display:flex; gap:12px; align-items:center; padding:0 16px 8px 16px; }
.cat-filter .label{ font-size:12.5px; color:#4b5563; font-weight:700; }
.chips{ display:flex; flex-wrap:wrap; gap:8px; }
.chip{
  min-height:32px; padding:0 10px; border-radius:999px; border:1px solid var(--border);
  background:#fff; cursor:pointer; box-shadow:var(--shadow-xs); font-size:12.5px; color:#1f2a3a; font-weight:700;
}
.chip.active{ border-color:var(--accent); background:var(--accent-soft); }

/* ---------- Cards (personal view) ----------------------------------------- */
.cards{ display:grid; grid-template-columns: repeat(12, 1fr); gap:12px; margin:18px 0; padding:0 12px; }
.card{
  grid-column:span 4; background:#fff; border:1px solid var(--border);
  border-radius:var(--radius); box-shadow:var(--shadow); padding:14px 16px;
}
.card.stat .label{ font-size:12.5px; color:#4b5563; font-weight:700; }
.card.stat .value{ font-size:28px; font-weight:900; letter-spacing:-.02em; }
.card.stat .value .unit{ font-size:14px; font-weight:800; margin-left:4px; color:#334155; }
.card.stat .sub{ font-size:12.5px; color:#667892; margin-top:6px; }

/* ---------- Chart ---------------------------------------------------------- */
.chart-wrap{ padding:16px; }

/* ---------- Matrix Table --------------------------------------------------- */
.matrix-wrap{
  position:relative; overflow:auto; border-top:1px dashed var(--inset);
  border-radius:0 0 var(--radius) var(--radius);
}
.matrix{
  width:100%; min-width: 1200px;
  border-collapse: separate; border-spacing:0;
}
.matrix thead th{
  background:#f8fafc; font-size:12px; color:#667892; letter-spacing:.2px; font-weight:800;
  border-bottom:1px solid var(--border); padding:10px 10px; text-align:left;
  position: sticky; top: var(--sticky-offset); z-index: 5;
  vertical-align: bottom;
}
.matrix tbody td{
  padding:10px 10px; border-bottom:1px solid var(--hair); color:#0f172a; font-size:13px; vertical-align: top;
  background:#fff;
}
.matrix tbody tr:nth-child(odd) td{ background:#fbfcfe; }
.matrix tbody tr:hover td{ background:#fff; box-shadow: inset 0 1px 0 rgba(2,6,23,.04); }

/* Fixed first 3 columns: 중분류 / 항목 / 기준 */
.matrix .col-cat{ position:sticky; left:0; z-index:6; background:#fff; border-right:1px solid var(--border); min-width:200px; }
.matrix .col-item{ position:sticky; left:200px; z-index:6; background:#fff; border-right:1px solid var(--border); min-width:320px; }
.matrix .col-base{ position:sticky; left:520px; z-index:6; background:#fff; border-right:1px solid var(--border); min-width:90px; text-align:right; }

/* Worker columns */
.worker-col{ min-width:64px; text-align:center; }

/* Rotated header for many workers */
.wname{
  display:inline-block; transform: rotate(-65deg); transform-origin: bottom left;
  height:96px; line-height:1; white-space:nowrap; font-weight:800; color:#0f172a;
}
.matrix.dense .worker-col{ min-width:48px; }
.matrix.dense .wname{ height:108px; }

/* Category header row */
.cat-row td{
  position:sticky; left:0; z-index:4; background:#fff;
  font-weight:900; color:#0f172a; border-bottom:2px solid var(--border);
  padding:10px 10px; background: linear-gradient(180deg, #fff 0, #fff 60%, #f8fafc 100%);
}
.cat-row td:first-child{ left:0; }
.cat-row td:nth-child(2){ left:200px; }
.cat-row td:nth-child(3){ left:520px; }
.cat-row td{ box-shadow: 1px 0 0 var(--border) inset; }

/* PCI cell heatmap */
.pct{ display:inline-block; min-width:40px; text-align:right; font-variant-numeric: tabular-nums; }
.cell{
  border-radius:8px; padding:4px 6px; text-align:right;
  display:flex; justify-content:flex-end; gap:6px; align-items:center;
  box-shadow: inset 0 1px 0 rgba(2,6,23,.04);
}
.h0{ background:#f9f5f0; }
.h1{ background: color-mix(in srgb, var(--bad) 6%, #fff); }
.h2{ background: color-mix(in srgb, var(--bad) 10%, #fff); }
.h3{ background: color-mix(in srgb, var(--bad) 14%, #fff); }
.h4{ background: color-mix(in srgb, var(--bad) 18%, #fff); }
.h5{ background: color-mix(in srgb, #eab308 18%, #fff); }
.h6{ background: color-mix(in srgb, #eab308 26%, #fff); }
.h7{ background: color-mix(in srgb, var(--ok) 16%, #fff); }
.h8{ background: color-mix(in srgb, var(--ok) 26%, #fff); }
.h9{ background: color-mix(in srgb, var(--ok) 36%, #fff); }
.h10{ background: color-mix(in srgb, var(--ok) 48%, #fff); }

/* Badges */
.badge{
  border:1px solid var(--border); border-radius:999px; padding:4px 8px;
  font-size:12.5px; background:#fff; box-shadow:var(--shadow-xs); color:#1f2a3a;
}
.badge.ok{ background: color-mix(in srgb, var(--ok) 10%, #fff); border-color: color-mix(in srgb, var(--ok) 30%, var(--border)); color:#135a25; }
.badge.mid{ background: color-mix(in srgb, #eab308 14%, #fff); border-color: color-mix(in srgb, #eab308 30%, var(--border)); color:#694f00; }
.badge.bad{ background: color-mix(in srgb, var(--bad) 10%, #fff); border-color: color-mix(in srgb, var(--bad) 30%, var(--border)); color:#7a1111; }

/* Matrix meta */
.matrix-info{ color:#667892; padding:8px 16px 12px 16px; font-size:13px; }

/* ---------- Personal Table ------------------------------------------------- */
.table-scroll{ overflow:auto; border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow); background:#fff; margin:12px; }
.table{ width:100%; min-width: 1000px; border-collapse:separate; border-spacing:0; }
.table thead th{
  background:#f8fafc; font-size:12px; color:#667892; letter-spacing:.2px; font-weight:800;
  border-bottom:1px solid var(--border); padding:10px 10px; text-align:left;
  position: sticky; top: var(--sticky-offset); z-index: 3;
}
.table tbody td{
  padding:12px 10px; border-bottom:1px solid var(--hair); color:#0f172a; font-size:13px; vertical-align: top;
}
.table tbody tr:nth-child(odd){ background:#fbfcfe; }
.table tbody tr:hover{ background:#fff; box-shadow: inset 0 1px 0 rgba(2,6,23,.04); }

/* ---------- Loading -------------------------------------------------------- */
.loading{
  position:absolute; inset:0;
  background: rgba(255,255,255,.7);
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px;
  z-index:10;
}
.loading.hidden{ display:none; }
.spinner{ width:32px; height:32px; border:4px solid #ddd; border-top-color:#333; border-radius:50%; animation:spin 1s linear infinite; }
@keyframes spin{ to{ transform:rotate(360deg) } }

/* ---------- Responsive ----------------------------------------------------- */
@media (max-width:1024px){
  .field{ grid-column:span 6; }
  .card{ grid-column:span 12; }
}
@media (max-width:640px){
  .field{ grid-column:span 12; }
  .matrix .col-cat{ min-width:160px; }
  .matrix .col-item{ min-width:260px; left:160px; }
  .matrix .col-base{ min-width:80px; left:420px; }
  .cat-row td:nth-child(2){ left:160px; }
  .cat-row td:nth-child(3){ left:420px; }
}

/* ---------- Reduced motion / Print ---------------------------------------- */
@media (prefers-reduced-motion: reduce){
  *{ animation-duration:.001ms !important; animation-iteration-count:1 !important; transition-duration:.001ms !important; }
}
@media print{
  .nav, .filters, .cat-filter{ display:none !important; }
  body{ background:#fff; color:#000; }
  .panel{ box-shadow:none; border-color:#d1d5db; background:#fff; }
  .matrix thead th{ background:#fff; border-bottom:1px solid #d1d5db; position:static; }
  .matrix .col-cat, .matrix .col-item, .matrix .col-base,
  .cat-row td{ position:static; left:auto; }
}
