/* =============================================================================
S-WORKS — pci_supran.css

정돈된 매트릭스(기준=서브텍스트)

헤더/첫 열 겹침 개선, 분리선 강화, 가로 스크롤 차트

버튼/필터 인라인 정렬, 로딩 애니메이션, 모달 아코디언 로그
========================================================================== */

/* ---------- Tokens --------------------------------------------------------- */
:root{
--bg:#ffffff;
--surface:#f6f8fb;
--panel:#ffffff;

--text:#0f172a;
--muted:#475569;

--accent:#2563eb;
--accent-weak: rgba(37,99,235,.16);

--ok:#16a34a;
--mid:#f59e0b;
--bad:#dc2626;

--border:#e5e7eb;
--grid:#eef2f7;

--shadow-xs: 0 1px 1px rgba(2,6,23,.04);
--shadow: 0 8px 24px rgba(2,6,23,.08);

--radius:14px; --radius-md:12px; --radius-sm:10px;
--control-h:42px; --font-control:15px;
}

/* ---------- Base ----------------------------------------------------------- */
*,
::before,::after{ box-sizing:border-box; }
html,body{ height:100%; }
body{
margin:0;
background: linear-gradient(180deg, #fff 0 64px, var(--surface) 64px 100%);
color:var(--text);
font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', Arial, sans-serif;
-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
::selection{ background:var(--accent-weak); }
a{ color:var(--accent); text-decoration:none; }
a:hover{ text-decoration:underline; }

.hidden{ display:none!important; }

/* Tab panes */
.tab-pane{ display:none; }
.tab-pane.active{ display:block; }

/* Mono tabular numbers for large tables */
.mono, .matrix .pct, .table td, .table th{
font-variant-numeric: tabular-nums;
}

/* ---------- Buttons -------------------------------------------------------- */
.btn{
--btn-bg:#fff;
--btn-bd:var(--border);
--btn-fg:#0f172a;
display:inline-flex; align-items:center; justify-content:center; gap:8px;
height: var(--control-h); padding:0 14px;
border:1px solid var(--btn-bd); background:var(--btn-bg); color:var(--btn-fg);
border-radius:12px; font-weight:800; font-size:14px; cursor:pointer;
box-shadow: var(--shadow-xs); transition: transform .06s, box-shadow .12s, border-color .12s, background .12s;
}
.btn:hover{ transform: translateY(-1px); box-shadow: 0 3px 10px rgba(2,6,23,.08); }
.btn:active{ transform: translateY(0); }
.btn:focus-visible{ outline:none; box-shadow:0 0 0 3px rgba(37,99,235,.22); border-color: var(--accent); }
.btn:disabled{ opacity:.5; cursor:not-allowed; }

.btn.primary{
--btn-bg: color-mix(in srgb, var(--accent) 14%, #fff);
--btn-bd: color-mix(in srgb, var(--accent) 36%, var(--border));
--btn-fg:#0b216b;
}
.btn.ghost{
--btn-bg:#f8fafc;
--btn-bd:var(--border);
--btn-fg:#1f2a3a;
}
.btn.sm{ height:32px; padding:0 10px; font-size:12.5px; border-radius:10px; }

/* ---------- Nav ------------------------------------------------------------ */
.nav{
position:sticky; top:0; z-index:8000;
background:#fff; border-bottom:1px solid var(--border); box-shadow:var(--shadow-xs);
}
.inner{ max-width:1600px; margin:0 auto; padding:0 14px; }
.nav .inner{ display:flex; align-items:center; justify-content:space-between; min-height:56px; }
.brand{ font-weight:900; letter-spacing:.2px; color:inherit; }
.page-title{ font-weight:800; color:#111827; }

/* ---------- Layout --------------------------------------------------------- */
main.container{ max-width:1600px; margin:0 auto; padding:20px 14px 40px; }
.panel{
background:var(--panel); border:1px solid var(--border);
border-radius:var(--radius); box-shadow:var(--shadow); padding:14px; margin-bottom:14px;
}
.panel-header h2{ margin:0 0 6px; font-size:18px; font-weight:900; letter-spacing:-.01em; }
.hint{ color:#64748b; font-size:12.5px; }

.tabs{ display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap; }
.tab{
min-height:36px; padding:0 12px; border-radius:999px; border:1px solid var(--border);
background:#fff; cursor:pointer; font-weight:800; font-size:13px; color:#1f2a3a;
}
.tab.active{ border-color:var(--accent); background:rgba(37,99,235,.06); }

/* ---------- Filters -------------------------------------------------------- */
.filters{
display:grid; grid-template-columns: repeat(6, minmax(180px,1fr)); gap:10px;
background:#fbfcff; border:1px solid var(--border); border-radius:var(--radius-md);
box-shadow:var(--shadow-xs); padding:12px; margin-bottom:12px;
}
.filters .field{ display:flex; flex-direction:column; gap:6px; min-width:0; }
.filters label{ font-size:12.5px; color:#4b5563; font-weight:700; padding-left:2px; }
.input{
height: var(--control-h);
border-radius: var(--radius-sm);
border:1px solid var(--border); background:#fff; color:#0f172a;
padding:0 12px; box-shadow: inset 0 1px 0 rgba(2,6,23,.02);
font-size: var(--font-control);
}
.actions{ display:flex; align-items:end; gap:8px; }

/* 인라인 정렬(개인 보기) */
.filters.person{
grid-template-columns: 1fr auto;
align-items:end;
}
.field-inline label{ margin-bottom:2px; }
.inline-input{ display:flex; gap:8px; align-items:center; }
.inline-input > input{
height: var(--control-h);
border:1px solid var(--border); border-radius: var(--radius-sm); padding:0 12px; width:260px;
}
.actions-inline{ display:flex; gap:8px; align-items:end; }

/* ---------- Cards ---------------------------------------------------------- */
.cards{ display:grid; grid-template-columns: repeat(3, minmax(200px, 1fr)); gap:10px; margin-bottom:12px; }
.card.stat{
border:1px solid var(--border); border-radius:12px; background:#fff; box-shadow:var(--shadow-xs);
padding:12px;
}
.card.stat .label{ font-weight:800; color:#374151; font-size:12.5px; }
.card.stat .value{ font-weight:900; font-size:28px; letter-spacing:-.02em; display:flex; align-items:baseline; gap:6px; }
.card.stat .value .unit{ font-size:14px; color:#6b7280; }
.card.stat .sub{ color:#6b7280; font-size:12.5px; }

/* ---------- Matrix --------------------------------------------------------- */
.matrix-wrap{
overflow:auto; border:1px solid var(--border);
border-radius:12px; background:#fff;
position:relative;
}

/* 테이블 기본 */
.matrix{
width:100%; min-width:1120px; border-collapse:separate; border-spacing:0;
}
.matrix thead th{
position:sticky; top:0; z-index:5;
background:#f8fafc; font-size:12px; color:#64748b; letter-spacing:.1px; font-weight:800;
border-bottom:1px solid var(--border); padding:8px 10px; text-align:left; white-space:nowrap;
transition:background-color .12s ease;
}

/* 첫 2열(중분류/작업항목) 고정 + 헤더 겹침 해결 /
.matrix .item-col{
position:sticky; left:0; background:#fff; box-shadow: 1px 0 0 var(--grid);
white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.matrix thead .item-col{ z-index:8; } / 헤더의 왼쪽 고정열을 최상단 */
.matrix tbody .item-col{ z-index:4; }
.matrix .item-col:nth-child(1){ left:0; width:160px; }
.matrix .item-col:nth-child(2){ left:160px; width:260px; }

/* 작업자 헤더/셀 */
.matrix .worker-col{ min-width:68px; text-align:center; }
.matrix.dense .worker-col{ min-width:60px; }

/* 첫 작업자 열을 더 또렷하게 분리 */
.matrix thead th.worker-col:first-of-type,
.matrix tbody td.worker-col:first-of-type{
box-shadow: inset 1px 0 0 var(--grid);
}

/* 5열 단위 블록 구분 */
.worker-col.block-start{ box-shadow: inset 1px 0 0 var(--grid); }

/* 헤더 내 작업자 이름 */
.wname{
display:block; max-width: 100%; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* 카테고리 행 (접기/펼치기) */
.cat-row td{
background:#f8fafc; font-weight:900; color:#111827; border-bottom:1px solid var(--border);
padding:8px 10px;
}
.cat-row .caret{
display:inline-block; width:12px; transform: rotate(90deg); transition: transform .12s ease; margin-right:6px;
}
.cat-row.collapsed .caret{ transform: rotate(0); }

/* 셀(클릭 가능) */
.matrix tbody td{
padding:6px; border-bottom:1px solid var(--grid); color:#0f172a; font-size:13px; vertical-align: middle;
background:#fff;
}
.cell{
position:relative;
display:flex; flex-direction:column; align-items:center; justify-content:center; gap:2px;
height:44px; border-radius:10px; border:1px solid var(--border);
background:#fff; cursor:pointer;
transition: transform .06s, box-shadow .12s, border-color .12s, background .12s;
box-shadow:var(--shadow-xs); outline:none;
}
.cell:hover{ transform:translateY(-1px); box-shadow:0 2px 6px rgba(2,6,23,.08); border-color:#cfd7e3; }
.cell:active{ transform:translateY(0); }
.cell:focus-visible{ box-shadow:0 0 0 3px rgba(37,99,235,.2); border-color:var(--accent); }
.cell .pct{ font-weight:900; }

/* 기준(서브텍스트) */
.item-cell .meta{
margin-top:2px; font-size:12px; color:#6b7280;
}

/* 열 하이라이트 */
td.worker-col.col-hl, th.worker-col.col-hl{ background:#f7fbff; }

/* heat scale */
.h0{ background:linear-gradient(180deg, #fff, #fff); }
.h1{ background:linear-gradient(180deg, #fff, #fff4f5); }
.h2{ background:linear-gradient(180deg, #fff, #ffeef0); }
.h3{ background:linear-gradient(180deg, #fff, #ffe8eb); }
.h4{ background:linear-gradient(180deg, #fff, #fff3e0); }
.h5{ background:linear-gradient(180deg, #fff, #fff7d6); }
.h6{ background:linear-gradient(180deg, #fff, #eefbef); }
.h7{ background:linear-gradient(180deg, #fff, #dbf7e3); }
.h8{ background:linear-gradient(180deg, #fff, #c9f3de); }
.h9{ background:linear-gradient(180deg, #fff, #b4efcf); }
.h10{ background:linear-gradient(180deg, #fff, #a1ebc6); }

/* quick fade-in on refresh/search */
.fade-in{ animation: fadeIn .18s ease-out; }
@keyframes fadeIn{ from{opacity:0; transform:translateY(2px)} to{opacity:1; transform:none} }

/* ---------- Loading / Searching indicator --------------------------------- */
.loading-line{
position:sticky; top:0; left:0; right:0; height:3px; z-index:9;
opacity:0; pointer-events:none; transition: opacity .15s ease;
background: linear-gradient(90deg, transparent, var(--accent), transparent);
background-size: 200% 100%;
}
.is-loading > .loading-line{ opacity:1; animation: indeterminate 1.1s linear infinite; }
@keyframes indeterminate{
0%{ background-position: 200% 0; }
100%{ background-position: -200% 0; }
}

/* matrix skeletons */
.sk{ display:inline-block; border-radius:8px; background: #eef2f7; position:relative; overflow:hidden; }
.sk::after{
content:""; position:absolute; inset:0;
background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.7) 50%, rgba(255,255,255,0) 100%);
transform: translateX(-100%); animation: shimmer 1.25s infinite;
}
@keyframes shimmer{ 100%{ transform: translateX(100%); } }
.sk-line{ height:10px; width:70%; margin:8px auto; border-radius:999px; }
.sk-tag{ height:18px; width:80px; margin:6px; }
.sk-text{ height:16px; width:160px; margin:6px; }
.sk-tiny{ height:12px; width:70px; margin:4px 6px 6px; }
.sk-cell{ height:36px; width:90%; margin:4px auto; border-radius:10px; }

/* spinner text (existing) */
.loading{
display:flex; align-items:center; gap:10px; padding:10px 12px; margin-top:8px;
color:#334155; font-size:13px;
}
.spinner{
width:16px; height:16px; border-radius:50%;
border:2px solid #cbd5e1; border-top-color: var(--accent); animation: spin .8s linear infinite;
}
@keyframes spin{ to{ transform:rotate(360deg); } }

/* ---------- Person: Chart -------------------------------------------------- */
.chart-scroll{ overflow:auto; border:1px solid var(--border); border-radius:12px; background:#fff; }
.chart-inner{ min-width: 680px; }
#stackedChart{ display:block; width: 100%; height: 260px; }

/* ---------- Person Table --------------------------------------------------- */
.table-scroll{ overflow:auto; border:1px solid var(--border); border-radius:12px; background:#fff; position:relative; }
.table{
width:100%; min-width:1000px; border-collapse:separate; border-spacing:0;
}
.table thead th{
position:sticky; top:0; z-index:5;
background:#f8fafc; font-size:12px; color:#64748b; letter-spacing:.1px; font-weight:800;
border-bottom:1px solid var(--border); padding:8px 10px; text-align:left;
}
.table tbody td{
padding:8px 10px; border-bottom:1px solid var(--grid); color:#0f172a; font-size:13px; vertical-align: middle;
}
.table tbody tr:nth-child(odd){ background:#fbfcff; }

/* row click */
.row-click{ cursor:pointer; }
.row-click:hover td{ background:#f7fbff; }

/* badges */
.badge{
display:inline-block; border:1px solid var(--border); border-radius:999px; padding:2px 8px;
font-size:12px; background:#fff;
}
.badge.ok{ border-color: color-mix(in srgb, var(--ok) 45%, var(--border)); color:#065f46; background: color-mix(in srgb, var(--ok) 8%, #fff); }
.badge.mid{ border-color: color-mix(in srgb, var(--mid) 45%, var(--border)); color:#7c3e06; background: color-mix(in srgb, var(--mid) 8%, #fff); }
.badge.bad{ border-color: color-mix(in srgb, var(--bad) 45%, var(--border)); color:#7a1111; background: color-mix(in srgb, var(--bad) 8%, #fff); }

/* ---------- Modal ---------------------------------------------------------- */
body.modal-open{ overflow:hidden; }
.overlay{
position:fixed; inset:0; background: rgba(15,23,42,.46);
z-index:9500; opacity:0; visibility:hidden; transition: opacity .15s ease, visibility .15s ease;
pointer-events: none;
}
@supports (backdrop-filter: blur(8px)){
.overlay{ backdrop-filter: blur(8px) saturate(112%); }
}
.overlay.show{ opacity:1; visibility:visible; pointer-events:auto; }

.modal{
position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
z-index:9600; opacity:0; visibility:hidden; transition: opacity .15s ease, visibility .15s ease;
padding:0; pointer-events:none;
}
.modal.show{ opacity:1; visibility:visible; pointer-events:auto; }

.modal-card{
width: calc(100vw - 24px);
max-width: 1200px; max-height: 92vh;
margin: 12px; overflow-y: auto; overflow-x: hidden;
background:#fff; border:1px solid var(--border); border-radius: var(--radius);
box-shadow: var(--shadow); animation: modal-in .16s ease-out;
}
@keyframes modal-in{ from{ transform:translateY(6px); opacity:0 } to{ transform:none; opacity:1 } }

.modal-head{
position:sticky; top:0; z-index:2; background:#fff;
display:flex; align-items:center; gap:8px;
padding:12px 14px; border-bottom:1px solid var(--border);
}
.md-title{ font-weight:900; font-size:16px; letter-spacing:-.01em; margin-right:auto; }
.modal-tools{ display:flex; gap:8px; }

/* Modal body blocks */
.modal-body{ padding:14px; display:grid; grid-template-columns: 1fr; gap:12px; }
.modal-sec{ border:1px solid var(--border); border-radius:10px; padding:12px; background:#fff; overflow-x:hidden; }
.modal-sec h4{ margin:0 0 8px; font-size:14px; color:#555; }
.modal-sec.span-2{ grid-column:1 / -1; }

/* Key/Value grid */
.kv{ display:grid; grid-template-columns: 160px 1fr; gap:6px 10px; }
.kv .k{ color:#666; font-size:12.5px; font-weight:800; }
.kv .v{ font-size:14px; overflow-wrap:anywhere; word-break:break-word; }

/* Log accordion */
.log-tools{ display:flex; gap:8px; margin-bottom:8px; }
.log-accordion{ display:flex; flex-direction:column; gap:8px; }
.acc{
border:1px solid var(--border); border-radius:10px; overflow:hidden; background:#fff;
box-shadow: var(--shadow-xs);
}
.acc > summary{
list-style:none; cursor:pointer; user-select:none;
display:grid; grid-template-columns: 18px 120px 1fr 100px 56px; gap:10px;
align-items:center; padding:10px 12px; background:#f8fafc; font-weight:700; color:#1f2937;
border-bottom:1px solid var(--grid);
}
.acc > summary::-webkit-details-marker{ display:none; }
.acc .chev::before{ content:"▶"; display:inline-block; transform-origin:center; transition:transform .12s ease; color:#334155; }
.acc .sum-date{ font-variant-numeric: tabular-nums; color:#334155; }
.acc .sum-id{ color:#334155; opacity:.8; }
.acc .sum-eq{ color:#475569; }
.acc .sum-role{ color:#334155; }
.acc .sum-weight{ color:#64748b; }
.acc[open] .chev::before{ transform:rotate(90deg); }

.acc .acc-body{ padding:12px; display:grid; gap:10px; background:#fff; }
.kv6{ display:grid; grid-template-columns: 120px 1fr 90px 1fr 100px 1fr; gap:6px 10px; align-items:start; }
.kv6 .k{ color:#6b7280; font-weight:800; font-size:12.5px; }
.kv6 .v{ font-size:13.5px; color:#0f172a; word-break:break-word; }
.prejson{
margin:0; padding:10px 12px; background:#0f172a; color:#e5e7eb; font-size:12.5px; border-radius:8px;
overflow:auto; max-height:240px;
}

/* ---------- Footer --------------------------------------------------------- */
.footer{ padding:14px 0 32px; color:#6b7280; font-size:12.5px; }
.footer .inner{ max-width:1600px; margin:0 auto; padding:0 14px; }

/* ---------- Responsive ----------------------------------------------------- */
@media (max-width:1200px){
.acc > summary{ grid-template-columns: 18px 110px 1fr 90px 50px; }
.kv6{ grid-template-columns: 100px 1fr 80px 1fr 90px 1fr; }
}
@media (max-width:960px){
.filters{ grid-template-columns: repeat(2, minmax(180px,1fr)); }
.filters.person{ grid-template-columns: 1fr; }
.cards{ grid-template-columns: 1fr; }
.matrix .item-col:nth-child(1){ width:150px; }
.matrix .item-col:nth-child(2){ left:150px; width:230px; }
}