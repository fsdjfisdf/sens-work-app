<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SETUP BOARD</title>
  <link rel="stylesheet" href="./css/setupboard.css"/>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="brand-title">SETUP BOARD</div>
        <div class="brand-sub">설비별 Setup Step 진행상황</div>
      </div>
      <div class="top-actions">
        <button id="btnNew" class="btn primary">+ 신규 설비</button>
        <button id="btnHelp" class="btn icon" title="셋업 진행 순서도">?</button>
      </div>
    </div>
  </header>

  <main class="page">
    <section class="filters card">
      <div class="filters-grid">
        <div class="field">
          <label>EQ TYPE</label>
          <select id="fEqType">
            <option value="">ALL</option>
            <option value="SUPRA N">SUPRA N</option>
            <option value="SUPRA XP">SUPRA XP</option>
            <option value="INTEGER">INTEGER</option>
            <option value="PRECIA">PRECIA</option>
            <option value="ECOLITE">ECOLITE</option>
            <option value="GENEVA">GENEVA</option>
            <option value="HDW">HDW</option>
          </select>
        </div>

        <div class="field">
          <label>Site</label>
          <select id="fSite">
            <option value="">ALL</option>
            <option value="PT">평택(PT)</option>
            <option value="HS">화성(HS)</option>
            <option value="IC">이천(IC)</option>
            <option value="CJ">청주(CJ)</option>
          </select>
        </div>

        <div class="field">
          <label>Line</label>
          <select id="fLine">
            <option value="">ALL</option>
            <option value="P1">P1</option>
            <option value="P2">P2</option>
            <option value="P3">P3</option>
            <option value="P4">P4</option>
          </select>
        </div>

        <div class="field">
          <label>Board Status</label>
          <select id="fStatus">
            <option value="">ALL</option>
            <option value="PLANNED">PLANNED</option>
            <option value="IN_PROGRESS">IN_PROGRESS</option>
            <option value="DONE">DONE</option>
            <option value="HOLD">HOLD</option>
          </select>
        </div>

        <div class="field wide">
          <label>설비명 검색</label>
          <input id="fQ" type="text" placeholder="예) DPCB713"/>
        </div>

        <div class="field">
          <label>정렬</label>
          <select id="fSort" disabled>
            <option value="progress_asc">진행율 낮은순</option>
          </select>
        </div>

        <div class="field">
          <label>&nbsp;</label>
          <button id="btnApply" class="btn primary">적용</button>
        </div>
      </div>

      <div class="legend">
        <span class="chip"><span class="dot ns"></span>NOT_STARTED(-)</span>
        <span class="chip"><span class="dot pl"></span>PLANNED(P)</span>
        <span class="chip"><span class="dot ip"></span>IN_PROGRESS(I)</span>
        <span class="chip"><span class="dot dn"></span>DONE(D)</span>
        <span class="chip"><span class="dot hd"></span>HOLD(H)</span>
        <span class="muted small">· 설비명 클릭: 상세 모달</span>
      </div>
    </section>

    <section class="board card">
      <div class="board-head">
        <div class="board-title"><b id="statCount">-</b></div>
      </div>

      <div id="tableHost" class="table-host"></div>
    </section>
  </main>

  <!-- Detail Modal -->
  <div id="modal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>

    <div class="modal-card">
      <div class="modal-head">
        <div>
          <div id="mTitle" class="modal-title">설비 상세</div>
          <div id="mMeta" class="modal-meta muted">-</div>
        </div>
        <div class="modal-actions">
          <button id="btnClose" class="btn">닫기</button>
        </div>
      </div>

      <div class="modal-body">

        <div class="section">
          <div class="section-title">Project 정보</div>

          <div class="form-grid">
            <div class="field wide">
              <label>설비명</label>
              <input id="p_equipment_name" type="text"/>
            </div>

            <div class="field">
              <label>설비타입</label>
              <input id="p_equipment_type" type="text"/>
            </div>

            <div class="field">
              <label>Site</label>
              <input id="p_site" type="text" placeholder="PT/HS/IC/CJ"/>
            </div>

            <div class="field">
              <label>Line</label>
              <input id="p_line" type="text" placeholder="P1/P2/P3/P4"/>
            </div>

            <div class="field">
              <label>Location</label>
              <input id="p_location" type="text"/>
            </div>

            <div class="field">
              <label>Board Status</label>
              <select id="p_board_status">
                <option value="PLANNED">PLANNED</option>
                <option value="IN_PROGRESS">IN_PROGRESS</option>
                <option value="DONE">DONE</option>
                <option value="HOLD">HOLD</option>
              </select>
            </div>

            <div class="field">
              <label>Start Date (Auto)</label>
              <input id="p_start_date_auto" type="text" readonly/>
            </div>

            <div class="field wide">
              <label>Last Note</label>
              <textarea id="p_last_note" rows="3"></textarea>
            </div>
          </div>

          <div class="row-actions">
            <button id="btnSaveProject" class="btn primary">SAVE</button>
            <span id="projSaveHint" class="muted small"></span>
          </div>
        </div>

        <!-- toggle -->
        <div class="section">
          <div class="section-title">
            <span>진행 관리</span>
            <div class="seg" role="tablist" aria-label="mode">
              <button id="tabSteps" class="seg-btn active" type="button">Steps</button>
              <button id="tabPrereq" class="seg-btn" type="button">타업체 선행조건</button>
            </div>
          </div>

          <div id="viewSteps" class="view">
            <div id="stepsHost" class="steps-host"></div>
          </div>

          <div id="viewPrereq" class="view hidden">
            <div class="pr-top">
              <div class="muted small">* 체크/해제 후 “저장”을 눌러 DB에 반영됩니다.</div>
              <span id="prBadge" class="badge pr">0/0</span>
            </div>
            <div id="prereqHost" class="prereq-host"></div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="modal hidden">
    <div class="modal-backdrop" data-help-close="1"></div>

    <div class="modal-card help-card">
      <div class="modal-head">
        <div>
          <div class="modal-title">SETUP 진행 순서도</div>
          <div class="modal-meta muted">현장 기준 흐름(기본 가이드) · 설비/라인에 따라 일부 변형 가능</div>
        </div>
        <div class="modal-actions">
          <button id="btnHelpClose" class="btn">닫기</button>
        </div>
      </div>

      <div class="modal-body">
        <div class="help-grid2">
          <!-- LEFT: Main Flow -->
          <div class="help-panel">
            <div class="help-panel-head">
              <div class="help-h">메인 플로우</div>
              <div class="muted small">* 아래 순서대로 진행 (T/O 구간은 묶음으로 표시)</div>
            </div>

            <div class="flowchart">
              <!-- Phase 1 -->
              <div class="flow-phase">
                <div class="phase-title">PHASE 1 · 준비/반입</div>

                <div class="fc-node">
                  <div class="fc-no">1</div>
                  <div class="fc-body">
                    <div class="fc-title">TEMPLATE DRAW</div>
                    <div class="fc-tags">
                      <span class="tag2">문서/도면</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">2</div>
                  <div class="fc-body">
                    <div class="fc-title">TEMPLATE 확인</div>
                    <div class="fc-tags">
                      <span class="tag2">검증</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">3</div>
                  <div class="fc-body">
                    <div class="fc-title">FAB IN</div>
                    <div class="fc-tags">
                      <span class="tag2">반입</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">4</div>
                  <div class="fc-body">
                    <div class="fc-title">DOCKING</div>
                    <div class="fc-tags">
                      <span class="tag2">설치</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">5</div>
                  <div class="fc-body">
                    <div class="fc-title">CABLE H/U</div>
                    <div class="fc-tags">
                      <span class="tag2">케이블</span>
                      <span class="tag2 warn">선행: TRAY</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">6</div>
                  <div class="fc-body">
                    <div class="fc-title">SILICON</div>
                    <div class="fc-tags">
                      <span class="tag2">자재</span>
                      <span class="tag2">선행: AGV</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phase 2: T/O Bundle -->
              <div class="flow-phase">
                <div class="phase-title">PHASE 2 · T/O (전원/유틸/냉각/열교환/펌프)</div>

                <div class="fc-bundle">
                  <div class="bundle-head">
                    <div class="bundle-title">T/O 세트</div>
                    <div class="bundle-sub muted small">순서대로 진행</div>
                  </div>

                  <div class="bundle-grid">
                    <div class="bundle-item">
                      <div class="bn">7</div>
                      <div class="bt">
                        POWER T/O
                        <span class="mini warn">선행: 3상</span>
                      </div>
                    </div>
                    <div class="bundle-item">
                      <div class="bn">8</div>
                      <div class="bt">
                        UTILITY T/O
                        <span class="mini warn">선행: PCW PASS</span>
                      </div>
                    </div>
                    <div class="bundle-item">
                      <div class="bn">9</div>
                      <div class="bt">CHILLER T/O</div>
                    </div>
                    <div class="bundle-item">
                      <div class="bn">10</div>
                      <div class="bt">HEAT EX T/O</div>
                    </div>
                    <div class="bundle-item">
                      <div class="bn">11</div>
                      <div class="bt">PUMP T/O</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phase 3 -->
              <div class="flow-phase">
                <div class="phase-title">PHASE 3 · 구동/가스/인증</div>

                <div class="fc-node">
                  <div class="fc-no">12</div>
                  <div class="fc-body">
                    <div class="fc-title">TEACHING</div>
                    <div class="fc-tags">
                      <span class="tag2 warn">선행: LP SET UP</span>
                      <span class="tag2 warn">선행: OHT 인증</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">13</div>
                  <div class="fc-body">
                    <div class="fc-title">GAS T/O</div>
                    <div class="fc-tags">
                      <span class="tag2 warn">선행: GAS PASS</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">14</div>
                  <div class="fc-body">
                    <div class="fc-title">TTTM</div>
                    <div class="fc-tags">
                      <span class="tag2">가동</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">15</div>
                  <div class="fc-body">
                    <div class="fc-title">인증 준비</div>
                    <div class="fc-tags">
                      <span class="tag2">준비</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node">
                  <div class="fc-no">16</div>
                  <div class="fc-body">
                    <div class="fc-title">중간 인증</div>
                    <div class="fc-tags">
                      <span class="tag2 warn">선행: RF/환경/MFC/BKT</span>
                    </div>
                  </div>
                </div>

                <div class="fc-arrow">↓</div>

                <div class="fc-node strong">
                  <div class="fc-no">17</div>
                  <div class="fc-body">
                    <div class="fc-title">PROCESS CONFIRM</div>
                    <div class="fc-tags">
                      <span class="tag2 ok">완료</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- RIGHT: Prereqs -->
          <div class="help-panel">
            <div class="help-panel-head">
              <div class="help-h">타업체 선행조건</div>
              <div class="muted small">* 순서대로 체크 권장 · 상세 항목은 “타업체 선행조건” 탭에서 관리</div>
            </div>

            <div class="pr-flow">
              <div class="prf-item">
                <div class="prf-no">1</div>
                <div class="prf-body">
                  <div class="prf-title">TRAY 설치</div>
                  <div class="prf-sub muted">Before: CABLE H/U</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">2</div>
                <div class="prf-body">
                  <div class="prf-title">3상 설치</div>
                  <div class="prf-sub muted">Before: POWER T/O</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">3</div>
                <div class="prf-body">
                  <div class="prf-title">AGV 설치</div>
                  <div class="prf-sub muted">Before: SILICON</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">4</div>
                <div class="prf-body">
                  <div class="prf-title">PCW LINE 가압 PASS</div>
                  <div class="prf-sub muted">Before: UTILITY T/O</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">5</div>
                <div class="prf-body">
                  <div class="prf-title">LP SET UP</div>
                  <div class="prf-sub muted">Before: TEACHING</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">6</div>
                <div class="prf-body">
                  <div class="prf-title">OHT 가동 인증</div>
                  <div class="prf-sub muted">Before: TEACHING</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">7</div>
                <div class="prf-body">
                  <div class="prf-title">GAS LINE 가압 PASS</div>
                  <div class="prf-sub muted">Before: GAS T/O</div>
                </div>
              </div>

              <div class="prf-divider"></div>

              <div class="prf-item">
                <div class="prf-no">8</div>
                <div class="prf-body">
                  <div class="prf-title">RF CAL</div>
                  <div class="prf-sub muted">Before: 중간 인증</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">9</div>
                <div class="prf-body">
                  <div class="prf-title">환경 QUAL</div>
                  <div class="prf-sub muted">Before: 중간 인증</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">10</div>
                <div class="prf-body">
                  <div class="prf-title">MFC 인증</div>
                  <div class="prf-sub muted">Before: 중간 인증</div>
                </div>
              </div>

              <div class="prf-item">
                <div class="prf-no">11</div>
                <div class="prf-body">
                  <div class="prf-title">지진방지 BKT 체결</div>
                  <div class="prf-sub muted">Before: 중간 인증</div>
                </div>
              </div>

              <div class="tips2">
                <div class="tip2">
                  <div class="tip2-title">사용 팁</div>
                  <ul class="tip2-list">
                    <li>보드 셀 클릭 시 확인창 후 저장됩니다.</li>
                    <li>셀 hover 시 Plan/Actual/작업자/특이사항 확인 가능</li>
                    <li>진행률 바는 DONE 기준으로 계산</li>
                  </ul>
                </div>
                <div class="tip2 small muted">
                  * 실제 현장 상황에 따라 순서 일부 변형 가능
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Hover Tooltip -->
  <div id="tooltip" class="tooltip hidden"></div>
  <div id="toast" class="toast hidden"></div>

  <script src="./js/setupboard.js"></script>
</body>
</html>
