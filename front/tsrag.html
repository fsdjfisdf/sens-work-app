<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>S-WORKS · AI Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="tsrag.css" />
</head>
<body>
  <div class="ts-app">
    <!-- 좌측 사이드바 -->
    <aside class="ts-sidebar">
      <div class="ts-sidebar-header">
        <div class="ts-sidebar-logo">SE</div>
        <div class="ts-sidebar-text">
          <div class="ts-sidebar-title">SEnS/I</div>
          <div class="ts-sidebar-subtitle">AI Assistant</div>
        </div>
      </div>

      <button id="btnNewChat" class="ts-sidebar-new">
        <span>＋ 새 대화</span>
      </button>

      <!-- 상단 필터 박스 -->
      <div class="ts-header-right">
        <div class="ts-header-filter">
          <label class="ts-label-inline" for="equipmentTypeSelect">설비 타입</label>
          <select id="equipmentTypeSelect" class="ts-input-select">
            <option value="">전체</option>
            <option value="SUPRA N">SUPRA N</option>
            <option value="SUPRA XP">SUPRA XP</option>
            <option value="INTEGER Plus">INTEGER Plus</option>
            <option value="PRECIA">PRECIA</option>
            <option value="ECOLITE 300">ECOLITE 300</option>
            <option value="ECOLITE 3000">ECOLITE 3000</option>
            <option value="GENEVA">GENEVA</option>
            <option value="HDW">HDW</option>
          </select>
        </div>

        <div class="ts-header-filter">
          <label class="ts-label-inline" for="alarmKeySelect">AlarmKey</label>
          <select id="alarmKeySelect" class="ts-input-select">
            <option value="">전체</option>
            <option value="SUPRA N - Pin Move Timeout Alarm">SUPRA N - Pin Move Timeout Alarm</option>
            <option value="SUPRA N - Diff Temp Interlock">SUPRA N - Diff Temp Interlock</option>
            <option value="SUPRA N - EFEM Robot COM Error">SUPRA N - EFEM Robot COM Error</option>
            <option value="SUPRA N - EFEM to CTC Communication Alarm">SUPRA N - EFEM to CTC Communication Alarm</option>
            <option value="SUPRA N - Fast Vacuum Timeout Alarm">SUPRA N - Fast Vacuum Timeout Alarm</option>
            <option value="SUPRA N - Fast Vent Timeout Alarm">SUPRA N - Fast Vent Timeout Alarm</option>
            <option value="SUPRA N - Slow Vent Timeout Alarm">SUPRA N - Slow Vent Timeout Alarm</option>
            <option value="SUPRA N - Leak Rate Over Alarm">SUPRA N - Leak Rate Over Alarm</option>
            <option value="SUPRA N - Chamber Open Alarm">SUPRA N - Chamber Open Alarm</option>
            <option value="SUPRA N - Chamber Temp Limit Alarm">SUPRA N - Chamber Temp Limit Alarm</option>
            <option value="SUPRA N - Slow Vacuum Time Out Alarm">SUPRA N - Slow Vacuum Time Out Alarm</option>
            <option value="SUPRA N - C/S Pin Move Timeout Alarm">SUPRA N - C/S Pin Move Timeout Alarm</option>
            <option value="SUPRA N - CTC to PMC Communication Alarm">SUPRA N - CTC to PMC Communication Alarm</option>
            <option value="SUPRA N - Door Valve Open/Close Timeout Alarm">SUPRA N - Door Valve Open/Close Timeout Alarm</option>
            <option value="SUPRA N - EFEM FFU Limit Alarm">SUPRA N - EFEM FFU Limit Alarm</option>
            <option value="SUPRA N - TM FFU Limit Alarm">SUPRA N - TM FFU Limit Alarm</option>
            <option value="SUPRA N - Chamber PCW Limit Alarm">SUPRA N - Chamber PCW Limit Alarm</option>
            <option value="SUPRA N - TM Robot Communication Alarm">SUPRA N - TM Robot Communication Alarm</option>
            <option value="SUPRA N - Gas Stable Timeout Alarm">SUPRA N - Gas Stable Timeout Alarm</option>
            <option value="SUPRA N - TM FFU Communication Fail Alarm">SUPRA N - TM FFU Communication Fail Alarm</option>
            <option value="SUPRA N - TM Side Door Open Alarm">SUPRA N - TM Side Door Open Alarm</option>
            <option value="SUPRA N - Device Net Communication Alarm">SUPRA N - Device Net Communication Alarm</option>
            <option value="SUPRA N - EFEM Robot Wafer Sensor Alarm">SUPRA N - EFEM Robot Wafer Sensor Alarm</option>
            <option value="SUPRA N - Gas Exhaust Alarm">SUPRA N - Gas Exhaust Alarm</option>
            <option value="SUPRA N - Slit Door Close Time out Alarm">SUPRA N - Slit Door Close Time out Alarm</option>
            <option value="SUPRA N - YASKAWA ROBOT Other Alarm">SUPRA N - YASKAWA ROBOT Other Alarm</option>
            <option value="SUPRA N - EFEM FFU Fail Alarm">SUPRA N - EFEM FFU Fail Alarm</option>
          </select>
        </div>

        <div class="ts-header-filter">
          <label class="ts-label-inline" for="topKInput">참조 개수</label>
          <input
            id="topKInput"
            type="number"
            class="ts-input-number"
            min="1"
            max="20"
            value="5"
          />
        </div>

        <button id="btnBuildEmbeddings" class="ts-btn ts-btn-ghost ts-btn-sm">
          ⚙️ Embedding (관리자용)
        </button>
      </div>

      <!-- 작업 이력 필터 -->
      <section id="workLogFilters" class="ts-wlog-filters">
        <div class="ts-wlog-header">
          <div class="ts-wlog-title">작업 이력 필터</div>
          <div class="ts-wlog-subtitle">
            필요할 때만 사용하세요. (설비 / 알람 조건 + 실제 작업 이력 조건을 동시에 줄 수 있습니다.)
          </div>
        </div>
        <div class="ts-wlog-grid">
          <!-- 날짜 범위 -->
          <div class="ts-wlog-field">
            <label for="filterDateFrom">기간</label>
            <div class="ts-wlog-date-row">
              <input type="date" id="filterDateFrom" class="ts-input-date" />
              <span class="ts-wlog-date-sep">~</span>
              <input type="date" id="filterDateTo" class="ts-input-date" />
            </div>
          </div>

          <!-- 설비 이름 -->
          <div class="ts-wlog-field">
            <label for="filterEqName">설비 이름</label>
            <input
              type="text"
              id="filterEqName"
              class="ts-input-text"
              placeholder="예: EPAB301"
            />
          </div>

          <!-- 작업자 이름 -->
          <div class="ts-wlog-field">
            <label for="filterWorker">작업자</label>
            <input
              type="text"
              id="filterWorker"
              class="ts-input-text"
              placeholder="예: 정현우"
            />
          </div>

          <!-- 그룹 -->
          <div class="ts-wlog-field">
            <label for="filterGroup">그룹</label>
            <select id="filterGroup" class="ts-input-select">
              <option value="">전체</option>
              <option value="PEE1">PEE1</option>
              <option value="PEE2">PEE2</option>
              <option value="PSKH">PSKH</option>
            </select>
          </div>

          <!-- 사이트 -->
          <div class="ts-wlog-field">
            <label for="filterSite">사이트</label>
            <select id="filterSite" class="ts-input-select">
              <option value="">전체</option>
              <option value="PT">PT</option>
              <option value="HS">HS</option>
              <option value="IC">IC</option>
              <option value="CJ">CJ</option>
              <option value="PSKH">PSKH</option>
            </select>
          </div>

          <!-- 작업 타입 -->
          <div class="ts-wlog-field">
            <label for="filterWorkType">작업 타입</label>
            <select id="filterWorkType" class="ts-input-select">
              <option value="">전체</option>
              <option value="SET UP">SET UP</option>
              <option value="MAINT">MAINT</option>
              <option value="RELOCATION">RELOCATION</option>
            </select>
          </div>

          <!-- SETUP ITEM -->
          <div class="ts-wlog-field">
            <label for="filterSetupItem">SETUP ITEM</label>
            <select id="filterSetupItem" class="ts-input-select" disabled>
              <option value="">선택</option>
              <option value="SELECT">SELECT</option>
              <option value="INSTALLATION PREPARATION">INSTALLATION PREPARATION</option>
              <option value="FAB IN">FAB IN</option>
              <option value="DOCKING">DOCKING</option>
              <option value="CABLE HOOK UP">CABLE HOOK UP</option>
              <option value="POWER TURN ON">POWER TURN ON</option>
              <option value="UTILITY TURN ON">UTILITY TURN ON</option>
              <option value="GAS TURN ON">GAS TURN ON</option>
              <option value="LEVELING">LEVELING</option>
              <option value="TEACHING">TEACHING</option>
              <option value="PART INSTALLATION">PART INSTALLATION</option>
              <option value="LEAK CHECK">LEAK CHECK</option>
              <option value="TTTM">TTTM</option>
              <option value="CUSTOMER CERTIFICATION">CUSTOMER CERTIFICATION</option>
              <option value="PROCESS CONFIRM">PROCESS CONFIRM</option>
            </select>
          </div>

          <!-- TRANSFER ITEM -->
          <div class="ts-wlog-field">
            <label for="filterTransferItem">TRANSFER ITEM</label>
            <select id="filterTransferItem" class="ts-input-select" disabled>
              <option value="">선택</option>
            </select>
            <div class="ts-wlog-help">
              설비 타입 + MAINT 선택 시 활성화됩니다.
            </div>
          </div>
        </div>
      </section>

      <div class="ts-sidebar-footer">
        <div class="ts-sidebar-footline">S-WORKS · AI</div>
        <div class="ts-sidebar-footdesc">SEnS/I</div>
      </div>
    </aside>

    <!-- 우측 메인 -->
    <div class="ts-main">
      <!-- 상단 헤더 -->
      <header class="ts-header">
        <div class="ts-header-left">
          <div class="ts-header-pill">
            <span class="ts-header-dot"></span>
            SEnS/I · AI
          </div>
          <div class="ts-header-title">
            Chat
          </div>
          <div class="ts-header-subtitle">
            Alarm + 실제 작업 이력을 동시에 참고하여, 현장 엔지니어에게 필요한 내용을 정리해 줍니다.
          </div>
        </div>

        <!-- 모바일용 필터 토글 버튼 -->
        <div class="ts-header-actions">
          <button id="filterToggle" class="ts-filter-toggle" type="button">
            <span class="ts-filter-toggle-icon">☰</span>
          </button>
        </div>
      </header>

      <!-- 중앙 채팅 영역 -->
      <main class="ts-chat-layout">
        <div class="ts-chat-column">
          <div id="chatMessages" class="ts-chat-messages"></div>

          <!-- 입력 영역 -->
          <div class="ts-input-panel">
            <div id="statusBox" class="ts-status ts-status-hidden"></div>

            <div class="ts-suggest-row">
              <span class="ts-suggest-label">추천 질문</span>
              <button
                class="ts-suggest-chip ts-sample"
                data-q="Diff Temp Interlock이 발생했을 때 Heater Chuck과 Pin 관련해서 각각 어떤 점검을 먼저 해야 하나요?"
              >
                Diff Temp Interlock 점검 포인트
              </button>
              <button
                class="ts-suggest-chip ts-sample"
                data-q="정현우 엔지니어의 최근 한 달간 SUPRA N 작업 이력을 요약해줘."
              >
                엔지니어 작업 요약
              </button>
            </div>

            <div class="ts-input-row">
              <div class="ts-input-box">
                <textarea
                  id="questionInput"
                  class="ts-input-textarea"
                  rows="1"
                  placeholder="알람 상황 / 작업 이력에 대해 자연스럽게 질문해 주세요."
                ></textarea>
              </div>
              <button id="btnAsk" class="ts-btn ts-btn-primary">
                전송
              </button>
            </div>
          </div>
        </div>
      </main>

      <!-- 하단 푸터 -->
      <footer class="ts-footer">
        <div class="ts-footer-inner">
          <span>S-WORKS · AI</span>
          <span>Developed by / SEnS/I</span>
        </div>
      </footer>
    </div>
  </div>

  <!-- 모바일에서 사이드바 열릴 때 사용하는 배경 -->
  <div class="ts-sidebar-backdrop" id="sidebarBackdrop"></div>
    <!-- 근거 상세 보기 모달 -->
  <div id="evidenceModal" class="ts-modal ts-modal-hidden">
    <div class="ts-modal-backdrop"></div>
    <div class="ts-modal-dialog">
      <header class="ts-modal-header">
        <div class="ts-modal-title-wrap">
          <div id="evidenceModalTag" class="ts-modal-tag">WORK LOG</div>
          <h2 id="evidenceModalTitle" class="ts-modal-title">제목</h2>
        </div>
        <button id="evidenceModalClose" class="ts-modal-close" type="button">✕</button>
      </header>

      <section class="ts-modal-meta" id="evidenceModalMeta"></section>

      <section class="ts-modal-body" id="evidenceModalBody"></section>

      <footer class="ts-modal-footer">
        <button id="evidenceModalCopy" class="ts-btn ts-btn-ghost ts-btn-sm" type="button">
          근거 내용 복사
        </button>
        <button id="evidenceModalClose2" class="ts-btn ts-btn-primary ts-btn-sm" type="button">
          닫기
        </button>
      </footer>
    </div>
  </div>
  

  <script src="tsrag.js"></script>
</body>
</html>
